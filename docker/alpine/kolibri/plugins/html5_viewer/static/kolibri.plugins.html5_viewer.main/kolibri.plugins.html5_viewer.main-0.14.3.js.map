{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///external \"kolibriCoreAppGlobal\"","webpack:///external \"kolibriCoreAppGlobal.utils.serverClock\"","webpack:///external \"kolibriCoreAppGlobal.coreVue.components.CoreFullscreen\"","webpack:///./kolibri/core/assets/src/utils/plugin_data_src.js","webpack:///external \"kolibriCoreAppGlobal.urls\"","webpack:///(webpack)/buildin/global.js","webpack:///./kolibri/plugins/html5_viewer/assets/src/views/Html5AppRendererIndex.vue?5f12","webpack:///./kolibri/plugins/html5_viewer/assets/src/views/Html5AppRendererIndex.vue?c65a","webpack:///./packages/hashi/src/mediator.js","webpack:///./packages/hashi/src/hashiBase.js","webpack:///./packages/hashi/src/baseShim.js","webpack:///./packages/hashi/src/baseStorage.js","webpack:///./packages/hashi/src/localStorage.js","webpack:///./packages/hashi/src/cookie.js","webpack:///./packages/hashi/src/SCORM.js","webpack:///./packages/hashi/src/mainClient.js","webpack:///./kolibri/plugins/html5_viewer/assets/src/views/Html5AppRendererIndex.vue","webpack:///./kolibri/plugins/html5_viewer/assets/src/views/Html5AppRendererIndex.vue?9a9f","webpack:///./kolibri/plugins/html5_viewer/assets/src/views/Html5AppRendererIndex.vue?3d50","webpack:///./kolibri/core/assets/src/utils/setWebpackPublicPath.js","webpack:///./node_modules/vue-loader/lib/runtime/componentNormalizer.js","webpack:///./kolibri/core/assets/src/kolibri_module.js","webpack:///./kolibri/plugins/html5_viewer/assets/src/module.js","webpack:///./kolibri/core/assets/src/content_renderer_module.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","kolibriCoreAppGlobal","utils","serverClock","coreVue","components","CoreFullscreen","global","urls","g","this","Function","e","window","Mediator","remote","local","addEventListener","handleMessage","__messageHandlers","ev","data","nameSpace","event","forEach","callback","console","debug","sendLocalMessage","message","postMessage","sendMessage","registerMessageHandler","push","removeMessageHandler","const","index","indexOf","splice","events","READYCHECK","READY","STATEUPDATE","USERDATAUPDATE","mediator","__mediator","assign","setData","__setData","stateUpdated","setUserData","__setUserData","userDataUpdated","on","values","includes","ReferenceError","off","userData","internalKeys","super","setDataToShim","setDataFromShim","updatedData","updated","shimKeys","keys","shim","String","entries","filter","entry","map","prop","iframeInitialize","__setShimInterface","configurable","self","Shim","length","getItem","keyName","setItem","removeItem","clear","NOW","__clearData","__nowDiff","__setNowDiff","__getCookies","__setItem","__data","rootCookies","byPath","__removeExpiredCookies","output","filterCookies","sourceObj","out","Date","expires","__now","path","filtered","document","set","now","nowDiff","setNow","getTime","pathname","location","join","valueString","parts","split","store","deleteCookie","pathRegex","maxAgeRegex","expiresRegex","slice","part","pathResult","exec","maxAgeResult","expiresResult","maxAge","Number","isNaN","expirationDate","__removeItem","logger","ERRORS","READ_WRITE","CMIDecimal","validate","timeSpanRegex","CMITimeSpan","test","convertFromSeconds","seconds","format","Math","round","floor","h","timeRegex","isStringLike","CMIString255","CMIString4096","CMIIdentifier","lowerCaseLetterNumber","singleLowerCaseLetterNumber","trueFalse","CMIFeedback","obj","type","substring","every","SCORE_SCHEMA","hasChildren","raw","readWrite","min","max","STATUS_SCHEMA","passed","completed","failed","incomplete","browsed","SCHEMA","cmi","core","student_id","fromUserData","userId","student_name","userFullName","lesson_location","credit","lesson_status","progress","score","total_time","timeSpent","lesson_mode","complete","exit","suspend","logout","session_time","launch_data","comments","comments_from_lms","objectives","arraySchema","id","status","student_data","mastery_score","notImplemented","max_time_allowed","time_limit_action","student_preference","language","audio","speed","text","interactions","time","choice","matching","performance","sequencing","likert","numeric","correct_responses","pattern","weighting","student_response","result","correct","wrong","unanticipated","neutral","latency","suspend_data","throwError","errorCode","error","TypeError","getByKeyPath","keyPath","localSchema","period","leadingKeyPath","substr","innerObj","innerKeyPath","innerSchema","Array","isArray","statusProgressMap","__calculateProgress","lessonStatus","parent","API","DOMException","warn","LMSInitialize","LMSFinish","LMSSetValue","CMIElement","setByKeyPath","LMSGetValue","LMSCommit","LMSGetLastError","LMSGetErrorString","LMSGetDiagnostic","iframe","contentWindow","storage","localStorage","cookie","SCORM","initialize","contentState","__setListeners","updateData","JSON","parse","stringify","getProgress","onStateUpdate","onProgressUpdate","PROGRESSUPDATE","iOSTest","IE11Test","isInFullscreen","computed","rooturl","iOSorIE11","navigator","userAgent","defaultFile","storage_url","iframeHeight","options","height","iframeWidth","width","contentRendererHeight","x","y","parseInt","sandbox","html5_sandbox_tokens","fullscreenText","$tr","lang","containerStyle","position","top","bottom","watch","newValue","hashi","mounted","$refs","$emit","extraFields","startTime","pollProgress","beforeDestroy","timeout","clearTimeout","methods","recordProgress","totalTime","hashiProgress","setTimeout","$trs","exitFullscreen","enterFullscreen","scriptExports","render","staticRenderFns","functionalTemplate","injectStyles","scopeId","moduleIdentifier","shadowMode","hook","_compiled","functional","_scopeId","context","$vnode","ssrContext","__VUE_SSR_CONTEXT__","_registeredComponents","add","_ssrRegister","$root","$options","shadowRoot","_injectStyles","originalRender","existing","beforeCreate","concat","_vm","_h","$createElement","_c","_self","ref","staticClass","style","$event","backgroundColor","$themePalette","grey","v_100","attrs","html5Renderer","toggleFullscreen","_v","_s","static","KolibriModule","safeOptions","kolibriModuleOptions","option","args","_registerKolibriModule","registerKolibriModuleSync","ready","stopListening","method","emit","Kolibri","hTML5AppModule","rendererComponent","loadDirectionalCSS","direction"],"mappings":"mBACE,IAAIA,iBAAmB,GAGvB,SAASC,oBAAoBC,UAG5B,GAAGF,iBAAiBE,UACnB,OAAOF,iBAAiBE,UAAUC,QAGnC,IAAIC,OAASJ,iBAAiBE,UAAY,CACzCG,EAAGH,SACHI,GAAG,EACHH,QAAS,IAUV,OANAI,QAAQL,UAAUM,KAAKJ,OAAOD,QAASC,OAAQA,OAAOD,QAASF,qBAG/DG,OAAOE,GAAI,EAGJF,OAAOD,QAKfF,oBAAoBQ,EAAIF,QAGxBN,oBAAoBS,EAAIV,iBAGxBC,oBAAoBU,EAAI,SAASR,QAASS,KAAMC,QAC3CZ,oBAAoBa,EAAEX,QAASS,OAClCG,OAAOC,eAAeb,QAASS,KAAM,CAAEK,YAAY,EAAMC,IAAKL,UAKhEZ,oBAAoBkB,EAAI,SAAShB,SACX,oBAAXiB,QAA0BA,OAAOC,aAC1CN,OAAOC,eAAeb,QAASiB,OAAOC,YAAa,CAAEC,MAAO,WAE7DP,OAAOC,eAAeb,QAAS,aAAc,CAAEmB,OAAO,KAQvDrB,oBAAoBsB,EAAI,SAASD,MAAOE,MAEvC,GADU,EAAPA,OAAUF,MAAQrB,oBAAoBqB,QAC/B,EAAPE,KAAU,OAAOF,MACpB,GAAW,EAAPE,MAA8B,iBAAVF,OAAsBA,OAASA,MAAMG,WAAY,OAAOH,MAChF,IAAII,GAAKX,OAAOY,OAAO,MAGvB,GAFA1B,oBAAoBkB,EAAEO,IACtBX,OAAOC,eAAeU,GAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,QACtD,EAAPE,MAA4B,iBAATF,MAAmB,IAAI,IAAIM,OAAON,MAAOrB,oBAAoBU,EAAEe,GAAIE,IAAK,SAASA,KAAO,OAAON,MAAMM,MAAQC,KAAK,KAAMD,MAC9I,OAAOF,IAIRzB,oBAAoB6B,EAAI,SAAS1B,QAChC,IAAIS,OAAST,QAAUA,OAAOqB,WAC7B,WAAwB,OAAOrB,OAAgB,SAC/C,WAA8B,OAAOA,QAEtC,OADAH,oBAAoBU,EAAEE,OAAQ,IAAKA,QAC5BA,QAIRZ,oBAAoBa,EAAI,SAASiB,OAAQC,UAAY,OAAOjB,OAAOkB,UAAUC,eAAe1B,KAAKuB,OAAQC,WAGzG/B,oBAAoBkC,EAAI,GAIjBlC,oBAAoBA,oBAAoBmC,EAAI,G,2BClFrDhC,OAAOD,QAAUkC,sB,wECAjBjC,OAAOD,QAAUkC,qBAAqBC,MAAMC,a,yBCA5CnC,OAAOD,QAAUkC,qBAAqBG,QAAQC,WAAWC,gB,uECAzD,iBAIe,uBAACC,OAAgC,yBAAK,IAAI,sCAAwB,K,4DCJjFvC,OAAOD,QAAUkC,qBAAqBO,M,yBCAtC,IAAIC,EAGJA,EAAI,WACH,OAAOC,KADJ,GAIJ,IAECD,EAAIA,GAAK,IAAIE,SAAS,cAAb,GACR,MAAOC,GAEc,iBAAXC,SAAqBJ,EAAII,QAOrC7C,OAAOD,QAAU0C,G,sECnBjB,o7BAA+kB,G,0MCA/kB,I,gUCMMK,SACJ,SAAYC,QACVL,KAAKM,MAAQH,OACbH,KAAKK,OAASA,OACdL,KAAKM,MAAMC,iBAAiB,UAAWP,KAAKQ,cAAczB,KAAKiB,OAC/DA,KAAKS,kBAAoB,I,mBAG3BD,cAAA,SAAcE,IACd,IAAF,IAAuCA,GAAGC,KAA9BC,UAAA,IAAAA,UAAWC,MAAA,IAAAA,MAAOF,KAAA,IAAAA,UAED,IAAdC,gBAA8C,IAAVC,OAG3Cb,KAAKS,kBAAkBG,YAAcZ,KAAKS,kBAAkBG,WAAWC,QACzEb,KAAKS,kBAAkBG,WAAWC,OAAOC,SAAQ,SAAAC,UAC/C,IACEA,SAASJ,MACT,MAAOT,GAEPc,QAAQC,MAAM,sCAAsCL,UAAS,cAAcC,OAC3EG,QAAQC,MAAMf,Q,mBAOtBgB,iBAAA,SAAiB,U,cAA6B,I,IACtCC,QAAU,CAChB,M,UACA,K,SACA,U,eAEAnB,KAAKM,MAAMc,YAAYD,QAAS,M,mBAGlCE,YAAA,SAAY,K,IACJF,QAAU,CAChB,M,UACA,K,SACA,U,eAEAnB,KAAKK,OAAOe,YAAYD,QAAS,M,mBAGnCG,uBAAA,SAAuB,U,cAAiC,I,kEAEhC,mBAAbP,eACU,IAAVF,YACc,IAAdD,YAIJZ,KAAKS,kBAAkBG,aAC1BZ,KAAKS,kBAAkBG,WAAa,IAEjCZ,KAAKS,kBAAkBG,WAAWC,SACrCb,KAAKS,kBAAkBG,WAAWC,OAAS,IAE7Cb,KAAKS,kBAAkBG,WAAWC,OAAOU,KAAKR,Y,mBAGhDS,qBAAA,SAAqB,U,cAAiC,I,kEACpD,GAAKxB,KAAKS,kBAAkBG,YAGvBZ,KAAKS,kBAAkBG,WAAWC,OAAvC,CAGA,GAAIE,SAAU,CACZU,IAAMC,MAAQ1B,KAAKS,kBAAkBG,WAAWC,OAAOc,QAAQZ,UAC/D,GAAIW,OAAS,EACX,OAAO1B,KAAKS,kBAAkBG,WAAWC,OAAOe,OAAOF,MAAO,GAIlE1B,KAAKS,kBAAkBG,WAAWC,OAAS,KAIhC,0BCvFFgB,OAAS,CACpBC,WAAY,aACZC,MAAO,QACPC,YAAa,cACbC,eAAgB,kBCFG,kBACnB,SAAYC,UACVlC,KAAKmC,WAAaD,SAClBlC,KAAK6B,OAAS5D,OAAOmE,OAAO,GAAIP,S,4BAGlCQ,QAAA,SAAQ1B,MACNX,KAAKsC,UAAU3B,MACfX,KAAKuC,gB,4BAGPC,YAAA,SAAY7B,MACNX,KAAKyC,gBACPzC,KAAKyC,cAAc9B,MACnBX,KAAK0C,oB,4BAITrB,YAAA,SAAYR,MAAOF,MACjBX,KAAKmC,WAAWd,YAAY,CAAET,UAAWZ,KAAKY,UAAWC,YAAOF,a,4BAGlEgC,GAAA,SAAG9B,MAAOE,UACR,IAAK9C,OAAO2E,OAAO5C,KAAK6B,QAAQgB,SAAShC,OACvC,MAAMiC,eAAkBjC,MAAK,kCAAkCb,KAAc,WAE/EA,KAAKmC,WAAWb,uBAAuB,CAAEV,UAAWZ,KAAKY,UAAWC,YAAOE,qB,4BAG7EgC,IAAA,SAAIlC,MAAOE,UACT,IAAK9C,OAAO2E,OAAO5C,KAAK6B,QAAQgB,SAAShC,OACvC,MAAMiC,eAAkBjC,MAAK,kCAAkCb,KAAc,WAE/EA,KAAKmC,WAAWX,qBAAqB,CAAEZ,UAAWZ,KAAKY,UAAWC,YAAOE,qB,4BAG3EwB,aAAA,WACEvC,KAAKqB,YAAYrB,KAAK6B,OAAOG,YAAahC,KAAKW,O,4BAGjD+B,gBAAA,WACE1C,KAAKqB,YAAYrB,KAAK6B,OAAOI,eAAgBjC,KAAKgD,W,+BC/BhDC,aAAe,CAAC,SAAU,MAAO,UAAW,UAAW,aAAc,S,aCFtB,sBACnD,sBAAYf,UACVgB,iBAAM,KAAAhB,UACNlC,KAAKY,UAAY,eACjBZ,KAAKsC,UAAYtC,KAAKsC,UAAUvD,KAAKiB,MACrCA,KAAK2C,GAAG3C,KAAK6B,OAAOG,YAAahC,KAAKsC,W,+LALW,CDIJ,mBAC/C,qBAAYJ,UACVgB,cAAM,KAAAhB,UACNlC,KAAKW,KAAO,G,kKAGd,YAAF,UAAE2B,UAAA,SAAU3B,W,gBAAO,IACfX,KAAKW,KAAOA,KACZX,KAAKmD,iBAQP,YAAF,UAAEC,gBAAA,W,gBACQC,YAAcpF,OAAOmE,OAAO,GAAIpC,KAAKW,MACvC2C,SAAU,EACRC,SAAWtF,OAAOuF,KAAKxD,KAAKyD,MAElCF,SAASzC,SAAQ,SAAAhC,KAEf,IAAKmE,aAAaJ,SAAS/D,KAAM,CAC/B2C,IAAMjD,MAAQkF,OAAO1D,OAAKyD,KAAK3E,MAC3BkB,OAAKW,KAAK7B,OAASN,QACrB6E,YAAYvE,KAAON,MACnB8E,SAAU,OAIhBrF,OAAOuF,KAAKxD,KAAKW,MAAMG,SAAQ,SAAAhC,KACxByE,SAASV,SAAS/D,MAASmE,aAAaJ,SAAS/D,cAC7CuE,YAAYvE,KACnBwE,SAAU,MAGVA,UACFtD,KAAKsC,UAAUe,aACfrD,KAAKuC,iBAIT,YAAF,UAAEY,cAAA,W,gBACMnD,KAAKyD,OAIPxF,OAAOmE,OAAA,MACL,OAAR,CAAQpC,KAAKyD,MAAI,OACNxF,OAAO0F,QAAQ3D,KAAKW,MACpBiD,QAAO,SAAAC,OAAK,OAAKZ,aAAaJ,SAASgB,MAAM,OAC7CC,KAAI,SAAAD,O,eAAS,IAAC,IAAGA,MAAM,IAAKA,MAAM,GAAC,SAGtB5F,OAAOuF,KAAKxD,KAAKyD,MACzB3C,SAAQ,SAAAiD,MACX/D,OAAKW,KAAKoD,cACN/D,OAAKyD,KAAKM,WAMzB,YAAF,UAAEC,iBAAA,WACEhE,KAAKiE,qBACLhG,OAAOC,eAAeiC,OAAQH,KAAKY,UAAW,CAC5CpC,MAAOwB,KAAKyD,KACZS,cAAc,KAIlB,YAAF,UAAED,mBAAA,WACExC,IAAM0C,KAAOnE,KAEPoE,KAAI,a,8CAmDV,OAlDE,mBAAIC,OAAA,eAEF,OADAF,KAAKf,kBACEnF,OAAOuF,KAAKW,KAAKxD,MAAM0D,QAGlC,KAAJ,UAAMvF,IAAA,SAAI4C,OAGF,OAFAyC,KAAKf,kBAEEnF,OAAOuF,KAAKW,KAAKxD,MAAMe,QAAU,MAG5C,KAAJ,UAAM4C,QAAA,SAAQC,SAGN,OAFAJ,KAAKf,kBAEEe,KAAKxD,KAAK4D,UAAY,MAGjC,KAAJ,UAAMC,QAAA,SAAQD,QAAS/F,OAIfA,MAAQkF,OAAOlF,OACf2F,KAAKxD,KAAK4D,SAAW/F,MAGhByE,aAAaJ,SAAS0B,WACzBvE,KAAKuE,SAAW/F,OAElB2F,KAAK5B,gBAGT,KAAJ,UAAMkC,WAAA,SAAWF,gBACFJ,KAAKxD,KAAK4D,SAGZtB,aAAaJ,SAAS0B,iBAClBvE,KAAKuE,SAEdJ,KAAK5B,gBAGT,KAAJ,UAAMmC,MAAA,WACEP,KAAKxD,KAAO,GACZwD,KAAK5B,gB,2DAGTvC,KAAKyD,KAAO,IAAIW,KAEhBpE,KAAKmD,gBAEEnD,KAAKyD,M,YA9HiC,CAAR,W,OEHG,mBAC1C,gBAAYvB,UACVgB,cAAM,KAAAhB,UACNjE,OAAOmE,OAAOpC,KAAK6B,OAAQ,CACzB8C,IAAK,QAEP3E,KAAKY,UAAY,SACjBZ,KAAK4E,cACL5E,KAAK6E,UAAY,EACjB7E,KAAKsC,UAAYtC,KAAKsC,UAAUvD,KAAKiB,MACrCA,KAAK8E,aAAe9E,KAAK8E,aAAa/F,KAAKiB,MAC3CA,KAAK+E,aAAe/E,KAAK+E,aAAahG,KAAKiB,MAC3CA,KAAKgF,UAAYhF,KAAKgF,UAAUjG,KAAKiB,MACrCA,KAAK2C,GAAG3C,KAAK6B,OAAOG,YAAahC,KAAKsC,WACtCtC,KAAK2C,GAAG3C,KAAK6B,OAAO8C,IAAK3E,KAAK8E,c,8LAGhC,OAAF,UAAEF,YAAA,WAKE5E,KAAKiF,OAAShH,OAAOmE,OAAO,GAJR,CAClB8C,YAAa,GACbC,OAAQ,MAKZ,OAAF,UAAEC,uBAAA,SAAuBzE,M,gBACf0E,OAAS,CACbH,YAAa,GACbC,OAAQ,IAGJG,cAAgB,SAAAC,WACpB9D,IAAM+D,IAAM,GAMZ,OALAvH,OAAOuF,KAAK+B,WAAWzE,SAAQ,SAAAhC,KACzB,IAAI2G,KAAKF,UAAUzG,KAAK4G,SAAW1F,OAAK2F,UAC1CH,IAAI1G,KAAOyG,UAAUzG,SAGlB0G,KAUT,OARAH,OAAOH,YAAcI,cAAc3E,KAAKuE,aACxCjH,OAAOuF,KAAK7C,KAAKwE,QAAQrE,SAAQ,SAAA8E,MAC/BnE,IAAMoE,SAAWP,cAAc3E,KAAKwE,OAAOS,OACvC3H,OAAOuF,KAAKqC,UAAUxB,SAExBgB,OAAOF,OAAOS,MAAQC,aAGnBR,QAGT,OAAF,UAAE/C,UAAA,SAAU3B,MACJA,MAAQA,KAAKuE,aAAevE,KAAKwE,OACnCnF,KAAKiF,OAASjF,KAAKoF,uBAAuBzE,MAE1CX,KAAK4E,eAIT,OAAF,UAAEZ,iBAAA,WACE/F,OAAOC,eAAe4H,SAAU9F,KAAKY,UAAW,CAC9CxC,IAAK4B,KAAK+E,aACVgB,IAAK/F,KAAKgF,UAKVd,cAAc,KAIlB,mBAAIvD,KAAA,e,gBAEIA,KAAO,CACXuE,YAAa,GACbC,OAAQ,IAGV,SAASG,cAAcC,WACrB9D,IAAM4D,OAAS,GAMf,OALApH,OAAOuF,KAAK+B,WAAWzE,SAAQ,SAAAhC,KAlFjB,YAmFRyG,UAAUzG,KAAK4G,UACjBL,OAAOvG,KAAOyG,UAAUzG,SAGrBuG,OAST,OAPA1E,KAAKuE,YAAcI,cAActF,KAAKiF,OAAOC,aAC7CjH,OAAOuF,KAAKxD,KAAKiF,OAAOE,QAAQrE,SAAQ,SAAA8E,MACtCnE,IAAMoE,SAAWP,cAActF,OAAKiF,OAAOE,OAAOS,OAC9C3H,OAAOuF,KAAKqC,UAAUxB,SACxB1D,KAAKwE,OAAOS,MAAQC,aAGjB7F,KAAKoF,uBAAuBzE,OAUrC,OAAF,UAAEgF,MAAA,WACE,OAAO,IAAIF,KAAKA,KAAKO,MAAQhG,KAAK6E,YAGpC,OAAF,UAAEC,aAAA,SAAamB,SACXjG,KAAK6E,UAAYoB,SAGnB,OAAF,UAAEC,OAAA,SAAOF,KACLhG,KAAK8E,aAAa,IAAIW,KAAKO,KAAKG,UAAYV,KAAKO,OACjDhG,KAAKqB,YAAYrB,KAAK6B,OAAO8C,IAAK3E,KAAK6E,YAGzC,OAAF,UAAEE,aAAA,WACEtD,IAAMd,KAAO1C,OAAOmE,OAAO,GAAIpC,KAAKiF,OAAOC,aACrCkB,SAAWjG,OAAOkG,SAASD,SAMjC,OAHIpG,KAAKiF,OAAOE,OAAOiB,WACrBnI,OAAOmE,OAAOzB,KAAMX,KAAKiF,OAAOE,OAAOiB,WAElCnI,OAAOuF,KAAK7C,MAChBmD,KAAI,SAAAhF,KAAG,OAAOA,IAAG,IAAI6B,KAAK7B,KAAU,SACpCwH,KAAK,OAGV,OAAF,UAAEtB,UAAA,SAAUuB,a,mDAAc,IACtB9E,IAAM+E,MAAQD,YAAYE,MAAM,KAChC,GAAID,MAAM,GAAI,CACZ,IAKIZ,KALV,IAA2BY,MAAM,GAAGC,MAAM,KAA7B3H,IAAA,OACD4H,MAAQ,CACZlI,MAFU,OAGVkH,QA1IY,WA6IViB,cAAe,EACbC,UAAY,YACZC,YAAc,eACdC,aAAe,eACrBN,MAAMO,MAAM,GAAGjG,SAAQ,SAAAkG,MACrB,IACEvF,IAAMwF,WAAaL,UAAUM,KAAKF,MAC5BG,aAAeN,YAAYK,KAAKF,MAChCI,cAAgBN,aAAaI,KAAKF,MACxC,GAAIC,WACFrB,KAAOqB,WAAW,QACb,GAAIE,aAAc,CAEvB1F,IAAM4F,OAASC,OAAOH,aAAa,IACnC,GAAII,MAAMF,QAER,OACSA,OAAS,EAClBX,MAAMhB,QAAU,IAAID,KAAKzF,OAAK2F,QAAQQ,UAAYkB,QAGlDV,cAAe,OAEZ,GAAIS,cAAe,CACxB3F,IAAM+F,eAAiB,IAAI/B,KAAK2B,cAAc,IAC9C,GAAIG,MAAMC,gBAER,OACSA,gBAAkB/B,KAAKO,MAEhCW,cAAe,EAMfD,MAAMhB,QAAU,IAAID,KAClBzF,OAAK2F,QAAQQ,WAAaqB,eAAerB,UAAYV,KAAKO,SAIhE,MAAO9F,QAMPyG,aACF3G,KAAKyH,aAAa3I,IAAK8G,MAEnBA,MACG5F,KAAKiF,OAAOE,OAAOS,QACtB5F,KAAKiF,OAAOE,OAAOS,MAAQ,IAE7B5F,KAAKiF,OAAOE,OAAOS,MAAM9G,KAAO4H,OAEhC1G,KAAKiF,OAAOC,YAAYpG,KAAO4H,MAGnC1G,KAAKuC,iBAIT,OAAF,UAAEkF,aAAA,SAAa3I,IAAK8G,MACZA,KACE5F,KAAKiF,OAAOE,OAAOS,eACd5F,KAAKiF,OAAOE,OAAOS,MAAM9G,KAC3Bb,OAAOuF,KAAKxD,KAAKiF,OAAOE,OAAOS,OAAOvB,eAGlCrE,KAAKiF,OAAOE,OAAOS,cAIvB5F,KAAKiF,OAAOC,YAAYpG,KAEjCkB,KAAKuC,gB,oEAvNmC,CAAR,UCF9BmF,OAAS1G,QAQT2G,gBACM,EADNA,8BAGoB,IAHpBA,oCAI0B,IAJ1BA,4BAKkB,IALlBA,6BAOmB,IAPnBA,0BAQgB,IARhBA,4BASkB,IATlBA,6BAUmB,IAVnBA,2BAWiB,IAGjBC,cAEA,KAFAA,cAGA,KAHAA,cAIA,KAGAC,WAAa,CACjBC,SAAA,SAAStJ,OACP,OAAQ+I,MAAM/I,SAMZuJ,cAAgB,2EAGhBC,YAAc,CAClBF,SAAA,SAAStJ,OACP,OAAOuJ,cAAcE,KAAKzJ,QAE5B0J,mBAAA,SAAmBC,SACjB1G,IAAM2G,OAAS,SAAA5J,OAAK,OAAKA,MAAQ,GAAK,IAAMA,MAAQA,OAE9Cc,EAAI+I,KAAKC,MAAOH,QAAU,GAAM,KAAO,IACvCxK,EAAI0K,KAAKE,MAAOJ,QAAU,KAAQ,IAClCK,EAAIH,KAAKE,MAAMJ,QAAU,MAG/B,OAAIK,GAAK,IACA,GAECJ,OAAOI,GAAE,IAAIJ,OAAOzK,GAAE,IAAIyK,OAAO9I,KAMzCmJ,UAAY,qEASlB,SAASC,aAAalK,OAGpB,OAAOkF,OAAOlF,QAAUA,MAG1BiD,IAAMkH,aAAe,CACnBb,SAAA,SAAStJ,OACP,OAAOkK,aAAalK,QAAUkF,OAAOlF,OAAO6F,QAAU,MAIpDuE,cAAgB,CACpBd,SAAA,SAAStJ,OACP,OAAOkK,aAAalK,QAAUkF,OAAOlF,OAAO6F,QAAU,OAIpDwE,cAAgB,CACpBf,SAAA,SAAStJ,OAKP,OAAOmK,aAAab,SAAStJ,SAAW,KAAKyJ,KAAKzJ,SAIhDsK,sBAAwB,WAE9B,SAASC,4BAA4BzJ,GACnC,OAAoB,IAAbA,EAAE+E,QAAgByE,sBAAsBb,KAAK3I,GAGtDmC,IAAMuH,UAAY,SAEZC,YAAc,CAClBnB,SAAA,SAAStJ,MAAO0K,KACd,GAtGU,KAsGN1K,MACF,OAAO,EACF,IAAKkK,aAAalK,OACvB,OAAO,EAIT,GADAA,MAAQkF,OAAOlF,OACE,eAAb0K,IAAIC,KAEN,OAAOH,UAAUf,KAAKzJ,QAA2B,IAAjBA,MAAM6F,OAExC,GAAiB,WAAb6E,IAAIC,KAAmB,CAGzB,GAAiB,MAAb3K,MAAM,GAAY,CACpB,GAAgC,MAA5BA,MAAMA,MAAM6F,OAAS,GAGvB,OAAO,EAFP7F,MAAQA,MAAM4K,UAAU,EAAG5K,MAAM6F,OAAS,GAK9C,OAAO7F,MAAMiI,MAAM,KAAK4C,MAAMN,6BAEhC,GAAiB,YAAbG,IAAIC,MAAmC,gBAAbD,IAAIC,KAEhC,OAAI3K,MAAM6F,QAAU,IAKtB,GAAiB,YAAb6E,IAAIC,KAEN,OAAOtB,WAAWC,SAAStJ,OAE7B,GAAiB,WAAb0K,IAAIC,KAEN,OAAOJ,4BAA4BvK,OAErC,GAAiB,aAAb0K,IAAIC,KAAqB,CAI3B,GAAiB,MAAb3K,MAAM,GAAY,CACpB,GAAgC,MAA5BA,MAAMA,MAAM6F,OAAS,GAGvB,OAAO,EAFP7F,MAAQA,MAAM4K,UAAU,EAAG5K,MAAM6F,OAAS,GAK9C,OAAO7F,MAAMiI,MAAM,KAAK4C,OAAM,SAAA/J,GAC5B,OAAoB,IAAbA,EAAE+E,QAAgB/E,EAAEmH,MAAM,KAAK4C,MAAMN,gCAGhD,MAAiB,eAAbG,IAAIC,MAEC3K,MAAMiI,MAAM,KAAK4C,MAAMN,+BAO9BO,aAAe,CACnBC,aAAa,EACbC,IAAK,CACHL,KAAMtB,WACN4B,UAAW7B,eAEb8B,IAAK,CACHP,KAAMtB,WACN4B,UAAW7B,eAEb+B,IAAK,CACHR,KAAMtB,WACN4B,UAAW7B,gBAITgC,cAAgB,CACpBH,UAAW7B,cACXhF,OAAQ,CACNiH,OAAQ,SACRC,UAAW,YACXC,OAAQ,SACRC,WAAY,aACZC,QAAS,UACT,gBAAiB,gBACjB,GAAI,KAIFC,OAAS,CACbC,IAAK,CACHZ,aAAa,EACba,KAAM,CACJb,aAAa,EACbc,WAAY,CACVlB,KAAMN,cACNyB,aAAA,SAAatH,UACX,OAAOA,SAASuH,QAAU,IAE5Bd,UAAW7B,eAEb4C,aAAc,CACZrB,KAAMR,aACN2B,aAAA,SAAatH,UACX,OAAOA,SAASyH,cAAgB,IAElChB,UAAW7B,eAEb8C,gBAAiB,CACfvB,KAAMR,aACNc,UAAW7B,eAEb+C,OAAQ,CACNL,aAAA,SAAatH,UACX,OAAOA,SAASuH,OAAS,SAAW,aAEtCd,UAAW7B,eAEbgD,cAAehB,cACf/F,MAAO,CACLyG,aAAA,SAAatH,UACX,OAAIA,SAAS6H,SACJ7H,SAAS6H,SAAW,EAAI,SAAW,GAErC,aAETpB,UAAW7B,eAEbkD,MAAOxB,aACPyB,WAAY,CACV5B,KAAMnB,YACNsC,aAAA,SAAatH,UACX,OAAOgF,YAAYE,mBAAmBlF,SAASgI,UAAYhI,SAASgI,UAAY,IAElFvB,UAAW7B,eAEbqD,YAAa,CACXX,aAAA,SAAatH,UACX,OAAIA,SAASuH,OACJvH,SAASkI,SAAW,SAAW,SAEjC,UAETzB,UAAW7B,eAEbuD,KAAM,CACJ1B,UAAW7B,cACXhF,OAAQ,CACN,WAAY,WACZwI,QAAS,UACTC,OAAQ,SACR,GAAI,KAGRC,aAAc,CACZnC,KAAMnB,YACNyB,UAAW7B,gBAGf2D,YAAa,CACXpC,KAAMP,cACNa,UAAW7B,eAEb4D,SAAU,CACRrC,KAAMP,cACNa,UAAW7B,eAEb6D,kBAAmB,CACjBtC,KAAMP,cACNa,UAAW7B,eAEb8D,WAAY,CACVnC,aAAa,EACboC,YAAa,CACXC,GAAI,CACFzC,KAAMN,cACNY,UAAW7B,eAEbkD,MAAOxB,aACPuC,OAAQjC,gBAIZkC,aAAc,CACZvC,aAAa,EACbwC,cAAe,CACbC,gBAAgB,EAChBvC,UAAW7B,eAEbqE,iBAAkB,CAChBD,gBAAgB,EAChBvC,UAAW7B,eAEbsE,kBAAmB,CACjBF,gBAAgB,EAChBvC,UAAW7B,gBAGfuE,mBAAoB,CAClB5C,aAAa,EACb6C,SAAU,CACRjD,KAAMR,aACN2B,aAAA,SAAatH,UACX,OAAOA,SAASoJ,SAAWpJ,SAASoJ,SAAW,IAEjD3C,UAAW7B,eAEbyE,MAAO,CACLL,gBAAgB,EAChBvC,UAAW7B,eAEb0E,MAAO,CACLN,gBAAgB,EAChBvC,UAAW7B,eAEb2E,KAAM,CACJP,gBAAgB,EAChBvC,UAAW7B,gBAGf4E,aAAc,CACZjD,aAAa,EACboC,YAAa,CACXC,GAAI,CACFzC,KAAMN,cACNY,UAAW7B,eAEb8D,WAAY,CACVC,YAAa,CACXC,GAAI,CACFzC,KAAMN,cACNY,UAAW7B,iBAIjB6E,KAAM,CACJtD,KA1RM,CACdrB,SAAA,SAAStJ,OACP,OAAOiK,UAAUR,KAAKzJ,SAyRhBiL,UAAW7B,eAEbuB,KAAM,CACJM,UAAW7B,cACXhF,OAAQ,CACN,aAAc,aACd8J,OAAQ,SACR,UAAW,UACXC,SAAU,WACVC,YAAa,cACbC,WAAY,aACZC,OAAQ,SACRC,QAAS,UACT,GAAI,KAGRC,kBAAmB,CACjBrB,YAAa,CACXsB,QAAS,CACPxD,UAAW7B,iBAIjBsF,UAAW,CACT/D,KAAMtB,WACN4B,UAAW7B,eAEbuF,iBAAkB,CAChBhE,KAAMF,YACNQ,UAAW7B,eAEbwF,OAAQ,CACN3D,UAAW7B,cACXE,SAAA,SAAStJ,OAQP,OAAOqJ,WAAWC,SAAStJ,QAPZ,CACb6O,QAAS,UACTC,MAAO,QACPC,cAAe,gBACfC,QAAS,UACT,GAAI,IAEsChP,SAGhDiP,QAAS,CACPhE,UAAW7B,cACXuB,KAAMnB,eAIZ0F,aAAc,CACZvE,KAAMP,cACNa,UAAW7B,iBAOjB,SAAS+F,WAAWC,WAClBnM,IAAMoM,MAAQC,UAAUF,WAExB,MADAC,MAAM/P,KAJiB,aAKjB+P,MAMD,SAASE,aAAa7E,IAAK8E,QAASC,YAAajL,UAYtD,GATKgL,SAAYC,aAAkC,iBAAZD,SACrCL,WAAWhG,+BAGTsG,YAAYD,UAAYC,YAAYD,SAASvE,YAAc7B,eAC7D+F,WAAWhG,8BAITsG,YAAYD,UAAYC,YAAYD,SAAS1D,aAC/C,OAAO2D,YAAYD,SAAS1D,aAAatH,UAI3C,GAAIkG,KAAOjL,OAAOkB,UAAUC,eAAe1B,KAAKwL,IAAK8E,SACnD,OAAO9E,IAAI8E,SAEbvM,IAAMyM,OAASF,QAAQrM,QAAQ,KAE/B,IAAgB,IAAZuM,OAAe,CACjBzM,IAAM0M,eAAiBH,QAAQI,OAAO,EAAGF,QACnCG,SAAWnF,IAAMA,IAAIiF,gBAAkBjF,IACvCoF,aAAeN,QAAQI,OAAOF,OAAS,GACzCK,YAAcN,YAAYE,gBAU9B,GATII,aAAeA,YAAY5C,YAG7B4C,YAAcA,YAAY5C,YAChBpE,MAAM4G,kBAGhBI,YAAcN,aAEK,WAAjBK,aAA2B,CAG7B,GAAIL,YAAYE,iBAAmBF,YAAYE,gBAAgBxC,YAE7D,OAAI6C,MAAMC,QAAQJ,UAETA,SAAShK,OAGT,EAKTsJ,WAAWhG,6BAGf,GAAqB,cAAjB2G,aAA8B,CAGhC,GAAIL,YAAYE,iBAAmBF,YAAYE,gBAAgB5E,YAG7D,OACEtL,OAAOuF,KAAK+K,aAGT3K,QAAO,SAAA9E,KAAG,MAAY,gBAARA,MAA0ByP,YAAYzP,KAAKkN,kBACzD1F,KAAK,KAKVqH,WAAWhG,qCAIf,OAAOoG,aAAaM,SAAUC,aAAcC,YAAavL,UAK3D,GAAIiL,YAAYD,WAAaC,YAAYD,SAAShC,eAEhD,MA1eU,GA2eDiC,YAAYD,UAAYC,YAAYD,SAAShC,gBAEtD2B,WAAWhG,8BAGbgG,WAAWhG,+BA2EblG,IAAMiN,kBAAoB,CACxB7E,OAAQ,EACRE,OAAQ,GACRE,QAAS,GACT,gBAAiB,EACjBD,WAAY,I,UAG6B,mBACzC,eAAY9H,UACVgB,cAAM,KAAAhB,UACNlC,KAAKW,KAAO,GACZX,KAAKgD,SAAW,GAChBhD,KAAKY,UAAY,QACjBZ,KAAKsC,UAAYtC,KAAKsC,UAAUvD,KAAKiB,MACrCA,KAAKyC,cAAgBzC,KAAKyC,cAAc1D,KAAKiB,MAC7CA,KAAK2C,GAAG3C,KAAK6B,OAAOG,YAAahC,KAAKsC,WACtCtC,KAAK2C,GAAG3C,KAAK6B,OAAOI,eAAgBjC,KAAKyC,e,0IAG3C,MAAF,UAAEH,UAAA,SAAU3B,W,gBAAO,IACfX,KAAKW,KAAOA,MAGd,MAAF,UAAE8B,cAAA,SAAcO,e,wBAAW,IACvBhD,KAAKgD,SAAWA,UAGlB,MAAF,UAAE2L,oBAAA,WACElN,IAAMqJ,MAAQiD,aAAa/N,KAAKW,KAAM,iBAAkBuJ,OAAQ/F,KAAKnB,UACrE,GAAI8H,MAAO,CAGTrJ,IAAMiI,IAAMpC,OAAOC,MAAMuD,MAAMpB,KAAO,EAAIoB,MAAMpB,KAC1CC,IAAMrC,OAAOC,MAAMuD,MAAMnB,KAAO,IAAMmB,MAAMnB,KAC5CH,IAAMlC,OAAOC,MAAMuD,MAAMtB,KAAOE,IAAMoB,MAAMtB,KAClD,OAAOnB,KAAKsB,IAAItB,KAAKqB,KAAKF,IAAME,MAAQC,IAAMD,KAAM,GAAI,GAE1DjI,IAAMmN,aAAeb,aAAa/N,KAAKW,KAAM,yBAA0BuJ,OAAQ/F,KAAKnB,UACpF,OAAI/E,OAAOkB,UAAUC,eAAe1B,KAAKgR,kBAAmBE,cACnDF,kBAAkBE,cAGpB,MAGT,MAAF,UAAE5K,iBAAA,WACEhE,KAAKiE,qBACL,IACE9D,OAAO0O,OAAOC,IAAM9O,KAAKyD,KACzB,MAAOvD,GACP,GAAIA,aAAa6O,aAMf,YAHArH,OAAOsH,KACL,mFAIJ,MAAM9O,IAIV,MAAF,UAAE+D,mBAAA,WACExC,IAAM0C,KAAOnE,KAET6N,MAAQlG,gBAENvD,KAAI,aA+DV,O,eA9DE6K,cAAA,WAGE,OAFAvH,OAAOzG,MAAM,yBACbkD,KAAK5B,eAtoBA,QA0oBT,KAAJ,UAAM2M,UAAA,WAEE,OADAxH,OAAOzG,MAAM,qBA3oBR,QA8oBT,KAAJ,UAAMkO,YAAA,SAAYC,WAAY5Q,OACtBqP,MAAQlG,gBACRD,OAAOzG,MAAM,iCAAiCmO,WAAU,cAAc5Q,OACtE,KA1JD,SAAS6Q,aAAanG,IAAK8E,QAASxP,MAAOyP,aAE3CD,SAAYC,aAAkC,iBAAZD,SACrCL,WAAWhG,+BAGblG,IAAMyM,OAASF,QAAQrM,QAAQ,KAC/B,IAAgB,IAAZuM,OAAe,CAEjBzM,IAAM0M,eAAiBH,QAAQI,OAAO,EAAGF,QAEnCI,aAAeN,QAAQI,OAAOF,OAAS,GAGzCK,YAAcN,YAAYE,gBAC1BI,aAAeA,YAAY5C,aAG7B4C,YAAcA,YAAY5C,YAG1BzC,IAAIiF,gBAAkBjF,IAAIiF,iBAAmB,IACnC5G,MAAM4G,kBAGhBI,YAAcN,aAIK,WAAjBK,cAA8C,cAAjBA,cAC/BX,WAAWhG,2BAIbuB,IAAIiF,gBAAkBjF,IAAIiF,iBAAmB,GAE7CkB,aAAanG,IAAIiF,gBAAiBG,aAAc9P,MAAO+P,iBAClD,CACL9M,IAAM8M,cAAcN,YAAYD,SAE5BO,eAAeA,cAAY9E,YAAc7B,eAC3C+F,WAAWhG,6BAGT4G,eAAeA,cAAYvC,gBAC7B2B,WAAWhG,8BAGR4G,eACHZ,WAAWhG,gCAKV4G,cAAYpF,OAASoF,cAAYpF,KAAKrB,SAAStJ,MAAO0K,MAGtDqF,cAAYzG,WAAayG,cAAYzG,SAAStJ,MAAO0K,MAGrDqF,cAAY3L,SAAW2L,cAAY3L,OAAOpE,SAGzC+P,cAAYpF,OAAST,aAAalK,SAEpCmP,WAAWhG,4BAGbuB,IAAI8E,SAAWxP,OAuFT6Q,CAAalL,KAAKxD,KAAMyO,WAAY5Q,MAAO0L,QAC3C,MAAOhK,GACP,GAAIA,aAAa4N,WAlQF,eAkQe5N,EAAEpC,KAE9B,OADA+P,MAAQ3N,EAAEiB,QAnpBR,QAspBJ,MAAMjB,EAGR,OADAiE,KAAK5B,eA1pBA,QA8pBT,KAAJ,UAAM+M,YAAA,SAAYF,YACVvB,MAAQlG,gBACRD,OAAOzG,MAAM,iCAAiCmO,YAC9C,IACE,OAAOrB,aAAa5J,KAAKxD,KAAMyO,WAAYlF,OAAQ/F,KAAKnB,UACxD,MAAO9C,GACP,GAAIA,aAAa4N,WAlRF,eAkRe5N,EAAEpC,KAE9B,OADA+P,MAAQ3N,EAAEiB,QAjqBR,GAoqBJ,MAAMjB,IAIZ,KAAJ,UAAMqP,UAAA,WAGE,OAFA1B,MAAQlG,gBACRD,OAAOzG,MAAM,qBA9qBR,QAkrBT,KAAJ,UAAMuO,gBAAA,WACE,OAAO3B,OAGX,KAAJ,UAAM4B,kBAAA,SAAkB7B,WAEhB,OADAlG,OAAOzG,MAAM,yCAAyC2M,WAnrBhD,IAurBV,KAAJ,UAAM8B,iBAAA,SAAiB9B,WAEf,OADAlG,OAAOzG,MAAM,uCAAuC2M,WAxrB9C,IA4rBV5N,KAAKyD,KAAO,IAAIW,KAETpE,KAAKyD,M,MA3H2B,CAAR,UCpkBd,sBACnB,SAAY,U,cAAkB,I,kCAG5B,GAFAzD,KAAK6B,OAASA,OACd7B,KAAK2P,OAASA,ONVO,UMWjB3P,KAAK2P,OAAO7R,KACd,MAAMgF,eACJ,+EAGJ9C,KAAKkC,SAAW,IAAI,aAASlC,KAAK2P,OAAOC,eACzC5P,KAAK6P,QAAU,CACbC,aAAc,IAAI,aAAa9P,KAAKkC,UACpC6N,OAAQ,IAAI,OAAO/P,KAAKkC,UACxB8N,MAAO,IAAI,UAAMhQ,KAAKkC,WAExBlC,KAAKgG,IAAMA,IACXhG,KAAKsC,UAAYtC,KAAKsC,UAAUvD,KAAKiB,O,uFAEvCiQ,WAAA,SAAWC,aAAclN,U,gBAUvBhD,KAAKsC,UAAU4N,aAAclN,UAC7BhD,KAAKmQ,iBAGLnQ,KAAK2C,GAAG3C,KAAK6B,OAAOE,OAAO,WACzB/B,OAAKsC,UAAUtC,OAAKW,KAAMX,OAAKgD,UAC/BhD,OAAKkC,SAASb,YAAY,CAAET,UNzCT,QMyCoBC,MAAOgB,OAAOE,MAAOpB,MAAM,OAEpEX,KAAKkC,SAASb,YAAY,CAAET,UN3CP,QM2CkBC,MAAOgB,OAAOC,WAAYnB,MAAM,K,gCAGzEyP,WAAA,SAAW,K,oEAILpN,WACFA,SAAWqN,KAAKC,MAAMD,KAAKE,UAAUvN,WACrChD,KAAKgD,SAAWA,UAEdkN,eACFA,aAAeG,KAAKC,MAAMD,KAAKE,UAAUL,gBAE3CjS,OAAOuF,KAAKxD,KAAK6P,SAAS/O,SAAQ,SAAAhC,KAChC2C,IAAMoO,QAAU7P,OAAK6P,QAAQ/Q,KACzBoR,cAAgBA,aAAaL,QAAQjP,YACvCiP,QAAQxN,QAAQ6N,aAAaL,QAAQjP,YAEnCoC,UACF6M,QAAQrN,YAAYQ,c,gCAK1BwN,YAAA,WAIE,OAAOxQ,KAAK6P,QAAQG,MAAMrB,uB,gCAG5BrM,UAAA,SAAU4N,aAAclN,UACtBhD,KAAKoQ,WAAW,CAAEF,0BAAclN,oBAC5BhD,KAAKgG,KACPhG,KAAK6P,QAAQE,OAAO7J,OAAOlG,KAAKgG,Q,gCAGpCmK,eAAA,W,gBACElS,OAAOuF,KAAKxD,KAAK6P,SAAS/O,SAAQ,SAAAhC,KAChBkB,OAAK6P,QAAQ/Q,KACrB6D,GAAGd,OAAOG,aAAa,WAC7BhC,OAAKkC,SAAShB,iBAAiB,CAAEN,UNrFhB,QMqF2BC,MAAOgB,OAAOG,YAAarB,KAAMX,OAAKW,cAIxF,8BAAIA,KAAA,e,gBACIA,KAAO,GAOb,OANA1C,OAAOuF,KAAKxD,KAAK6P,SAAS/O,SAAQ,SAAAhC,KAChC2C,IAAMoO,QAAU7P,OAAK6P,QAAQ/Q,KAG7B6B,KAAKkP,QAAQjP,WAAayP,KAAKC,MAAMD,KAAKE,UAAUV,QAAQlP,UAEvDA,M,gCAETgC,GAAA,SAAG9B,MAAOE,UACR,IAAK9C,OAAO2E,OAAOf,QAAQgB,SAAShC,OAClC,MAAMiC,eAAkBjC,MAAH,wCAEvBb,KAAKkC,SAASZ,uBAAuB,CAAEV,UNvGlB,QMuG6BC,YAAOE,qB,gCAG3D0P,cAAA,SAAc1P,UACZf,KAAK2C,GAAGd,OAAOG,YAAajB,W,gCAG9B2P,iBAAA,SAAiB3P,UACff,KAAK2C,GAAGd,OAAO8O,eAAgB5P,W,mKC7D7B6P,QAAU,wDACVC,SAAW,2CC1D+Q,oDDgEjR,CACb/S,KAAM,wBACN6B,WAAY,CACVC,eAAA,2EAEFe,KAAA,WACE,MAAO,CACLmQ,gBAAgB,IAGpBC,SAAU,CACRjT,KAAA,WACE,MPrEmB,SOuErBkT,QAAA,WACEvP,IACMwP,UADML,QAAQ3I,KAAKiJ,UAAUC,YACVN,SAAS5I,KAAKiJ,UAAUC,WAEjD,OAAOnR,KAAKoR,YAAYC,aAAeJ,UAAY,mBAAqB,KAE1EK,aAAA,WACE,OAAQtR,KAAKuR,SAAWvR,KAAKuR,QAAQC,QAzBd,SA2BzBC,YAAA,WACE,OAAQzR,KAAKuR,SAAWvR,KAAKuR,QAAQG,OAAU,QAEjDC,sBAAA,WACE,OA7BeC,EA6BI5R,KAAKsR,aA7BNO,EADE,OACIC,SAASF,EAAG,IAAME,SAASD,EAAG,IAAM,KAA9C,IAACD,EAAGC,GA+BpBE,QAAA,WACE,OAAO,kBAAYC,sBAErBC,eAAA,WACE,OAAOjS,KAAK8Q,eAAiB9Q,KAAKkS,IAAI,kBAAoBlS,KAAKkS,IAAI,oBAErElP,SAAA,WACE,MAAO,CACLuH,OAAQvK,KAAKuK,OACbE,aAAczK,KAAKyK,aACnBI,SAAU7K,KAAK6K,SACfK,SAAUlL,KAAK6K,UAAY,EAC3BuB,SAAUpM,KAAKmS,KAAKvG,GACpBZ,UAAWhL,KAAKgL,YAGpBoH,eAAA,WACE,OAAIpS,KAAK8Q,eACA,CACLuB,SAAU,WACVC,IApDgB,OAqDhBC,OAAQ,GAGL,CAAEf,OAAQxR,KAAKsR,gBAG1BkB,MAAO,CACLxP,SAAA,SAASyP,UACHA,UAAYzS,KAAK0S,OACnB1S,KAAK0S,MAAMtC,WAAW,CAAEpN,SAAUyP,aAIxCE,QAAA,W,gBACE3S,KAAK0S,MAAQ,IAAI,WAAM,CAAE/C,OAAQ3P,KAAK4S,MAAMjD,OAAQ3J,IAAA,uDACpDhG,KAAK0S,MAAMjC,eAAc,SAAA9P,MACvBX,OAAK6S,MAAM,qBAAsBlS,SAEnCX,KAAK0S,MAAMzC,WACRjQ,KAAK8S,aAAe9S,KAAK8S,YAAY5C,cAAiB,GACvDlQ,KAAKgD,UAEPhD,KAAK6S,MAAM,iBACX7S,KAAK+S,UAAY,+DACjB/S,KAAKgT,gBAEPC,cAAA,WACMjT,KAAKkT,SACPC,aAAanT,KAAKkT,SAEpBlT,KAAK6S,MAAM,iBAEbO,QAAS,CACPC,eAAA,WACE5R,IAAM6R,UAAY,+DAAQtT,KAAK+S,UACzBQ,cAAgBvT,KAAK0S,MAAQ1S,KAAK0S,MAAMlC,cAAgB,KAC9DxQ,KAAK6S,MACH,iBACkB,OAAlBU,cAAyBlL,KAAKsB,IAAI,EAAG2J,UAAY,KAAUC,eAE7DvT,KAAKgT,gBAEPA,aAAA,W,gBACEhT,KAAKkT,QAAUM,YAAW,WACxBxT,OAAKqT,mBACJ,QAGPI,KAAM,CACJC,eAAgB,kBAChBC,gBAAiB,oB,uBE5JrB,ICR6C7T,KDmB9B,sBEbA,SACb8T,cACAC,OACAC,gBACAC,mBACAC,aACAC,QACAC,iBACAC,YAGA,IAqBIC,KArBA7C,QAAmC,mBAAlBqC,cACjBA,cAAcrC,QACdqC,cAsDJ,GAnDIC,SACFtC,QAAQsC,OAASA,OACjBtC,QAAQuC,gBAAkBA,gBAC1BvC,QAAQ8C,WAAY,GAIlBN,qBACFxC,QAAQ+C,YAAa,GAInBL,UACF1C,QAAQgD,SAAW,UAAYN,SAI7BC,kBACFE,KAAO,SAAUI,UAEfA,QACEA,SACCxU,KAAKyU,QAAUzU,KAAKyU,OAAOC,YAC3B1U,KAAK6O,QAAU7O,KAAK6O,OAAO4F,QAAUzU,KAAK6O,OAAO4F,OAAOC,aAEZ,oBAAxBC,sBACrBH,QAAUG,qBAGRX,cACFA,aAAatW,KAAKsC,KAAMwU,SAGtBA,SAAWA,QAAQI,uBACrBJ,QAAQI,sBAAsBC,IAAIX,mBAKtC3C,QAAQuD,aAAeV,MACdJ,eACTI,KAAOD,WACH,WACAH,aAAatW,KACXsC,MACCuR,QAAQ+C,WAAatU,KAAK6O,OAAS7O,MAAM+U,MAAMC,SAASC,aAG3DjB,cAGFI,KACF,GAAI7C,QAAQ+C,WAAY,CAGtB/C,QAAQ2D,cAAgBd,KAExB,IAAIe,eAAiB5D,QAAQsC,OAC7BtC,QAAQsC,OAAS,SAAmCrL,EAAGgM,SAErD,OADAJ,KAAK1W,KAAK8W,SACHW,eAAe3M,EAAGgM,cAEtB,CAEL,IAAIY,SAAW7D,QAAQ8D,aACvB9D,QAAQ8D,aAAeD,SACnB,GAAGE,OAAOF,SAAUhB,MACpB,CAACA,MAIT,MAAO,CACL/W,QAASuW,cACTrC,QAASA,SFvFG,CACd,qDXTW,WAAa,IAAIgE,IAAIvV,KAASwV,GAAGD,IAAIE,eAAmBC,GAAGH,IAAII,MAAMD,IAAIF,GAAG,OAAOE,GAAG,iBAAiB,CAACE,IAAI,gBAAgBC,YAAY,iBAAiBC,MAAM,CAAGtE,OAAQ+D,IAAI5D,sBAAuBD,MAAO6D,IAAI9D,aAAe9O,GAAG,CAAC,iBAAmB,SAASoT,QAAQR,IAAIzE,eAAiBiF,UAAU,CAACL,GAAG,MAAM,CAACG,YAAY,oBAAoBC,MAAM,CAAGE,gBAAiBhW,KAAKiW,cAAcC,KAAKC,QAAU,CAACT,GAAG,UAAU,CAACU,MAAM,CAAC,SAAU,EAAM,WAAa,eAAezT,GAAG,CAAC,MAAQ,SAASoT,QAAQ,OAAOR,IAAI3C,MAAMyD,cAAcC,sBAAsB,CAAEf,IAAkB,eAAEG,GAAG,QAAQ,CAACG,YAAY,UAAUO,MAAM,CAAC,KAAO,qBAAqBV,GAAG,QAAQ,CAACG,YAAY,UAAUO,MAAM,CAAC,KAAO,gBAAgBb,IAAIgB,GAAG,WAAWhB,IAAIiB,GAAGjB,IAAItD,gBAAgB,WAAW,IAAI,GAAGyD,GAAG,MAAM,CAACG,YAAY,mBAAmBC,MAAOP,IAAkB,gBAAG,CAACG,GAAG,SAAS,CAACE,IAAI,SAASC,YAAY,SAASC,MAAM,CAAGE,gBAAiBT,IAAIU,cAAcC,KAAKC,OAASC,MAAM,CAAC,QAAUb,IAAIxD,QAAQ,YAAc,IAAI,KAAOwD,IAAIzX,KAAK,IAAMyX,IAAIvE,iBAC1+B,IWWpB,EACA,KACA,WACA,M,qNCf2ClR,K,2DEWxB,EFRjB,sBAA0BA,KAAK2W,OAAO,sCEU3B,IAAMC,cAcnB,SAAYnF,S,gFAIVvR,KAAKlC,KAAO,oCAEZ2D,IAAMkV,YAAc,GACpB3W,KAAK4W,qBAAqB9V,SAAQ,SAAA+V,QAC5BtF,QAAQsF,UACVF,YAAYE,QAAUtF,QAAQsF,YAGlC5Y,OAAOmE,OAAOpC,KAAM2W,cAExB,IAAI3W,MAAKiQ,WAAA,MAAW,IAAD,CAACsB,SAAO,OAAKuF,OAE5B9W,KAAK+W,0B,qGAzBP,kCAAIH,qBAAA,eACF,MAAO,I,wBAgCTG,uBAAA,WACE,wCAAQC,0BAA0BhX,O,wBAQpCiQ,WAAA,a,wBAOAgH,MAAA,a,wBAOAC,cAAA,SAAcrW,MAAOsW,QACnB,wCAAQD,cAAcrW,MAAOb,KAAMmX,S,wBAQrCC,KAAA,W,qEACE,wCAAQA,KAAA,MAAK,wCAAGN,OAElB,kCAAIO,QAAA,eACF,OAAO,yC,uFC9ELC,eAAiB,IAN2B,gC,qWAChD,mBAAIC,kBAAA,eACF,OAAO,uB,oFAFuC,CCDQ,wB,kUACxD,mBAAIA,kBAAA,eACF,OAAO,MAET,gBAAF,UAAEC,mBAAA,SAAmBC,WACjB,OAAOzX,KAAKqX,QAAQG,mBAAmBxX,KAAMyX,Y,sFALS,C","file":"kolibri.plugins.html5_viewer.main-0.14.3.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 8);\n","module.exports = kolibriCoreAppGlobal;","module.exports = kolibriCoreAppGlobal.utils.serverClock;","module.exports = kolibriCoreAppGlobal.coreVue.components.CoreFullscreen;","/*\n * Note - this module is not meant to be imported directly. Instead, use the global\n * alias 'plugin_data', which is provided by apiSpecExportTools.js\n */\nexport default (global['kolibriPluginDataGlobal'] || {})[__kolibriModuleName] || {};\n","module.exports = kolibriCoreAppGlobal.urls;","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","import mod from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../../../node_modules/css-loader/index.js??ref--4-1!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/lib/index.js??ref--4-2!../../../../../../node_modules/sass-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/svg-icon-inline-loader/index.js!./Html5AppRendererIndex.vue?vue&type=style&index=0&id=3448014e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../../../node_modules/css-loader/index.js??ref--4-1!../../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../node_modules/postcss-loader/lib/index.js??ref--4-2!../../../../../../node_modules/sass-loader/dist/cjs.js!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/svg-icon-inline-loader/index.js!./Html5AppRendererIndex.vue?vue&type=style&index=0&id=3448014e&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('CoreFullscreen',{ref:\"html5Renderer\",staticClass:\"html5-renderer\",style:({ height: _vm.contentRendererHeight, width: _vm.iframeWidth }),on:{\"changeFullscreen\":function($event){_vm.isInFullscreen = $event}}},[_c('div',{staticClass:\"fullscreen-header\",style:({ backgroundColor: this.$themePalette.grey.v_100 })},[_c('KButton',{attrs:{\"primary\":false,\"appearance\":\"flat-button\"},on:{\"click\":function($event){return _vm.$refs.html5Renderer.toggleFullscreen()}}},[(_vm.isInFullscreen)?_c('KIcon',{staticClass:\"fs-icon\",attrs:{\"icon\":\"fullscreen_exit\"}}):_c('KIcon',{staticClass:\"fs-icon\",attrs:{\"icon\":\"fullscreen\"}}),_vm._v(\"\\n      \"+_vm._s(_vm.fullscreenText)+\"\\n    \")],1)],1),_c('div',{staticClass:\"iframe-container\",style:(_vm.containerStyle)},[_c('iframe',{ref:\"iframe\",staticClass:\"iframe\",style:({ backgroundColor: _vm.$themePalette.grey.v_100 }),attrs:{\"sandbox\":_vm.sandbox,\"frameBorder\":\"0\",\"name\":_vm.name,\"src\":_vm.rooturl}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","/*\n * This class manages all message listening and sending from the postMessage\n * layer. All interfaces that need to message via the postMessage layer should\n * do so via an instance of this class.\n */\n\nclass Mediator {\n  constructor(remote) {\n    this.local = window;\n    this.remote = remote;\n    this.local.addEventListener('message', this.handleMessage.bind(this));\n    this.__messageHandlers = {};\n  }\n\n  handleMessage(ev) {\n    const { nameSpace, event, data } = ev.data;\n    // nameSpace and event should be defined, otherwise, it's not our message!\n    if (typeof nameSpace === 'undefined' || typeof event === 'undefined') {\n      return;\n    }\n    if (this.__messageHandlers[nameSpace] && this.__messageHandlers[nameSpace][event]) {\n      this.__messageHandlers[nameSpace][event].forEach(callback => {\n        try {\n          callback(data);\n        } catch (e) {\n          /* eslint-disable no-console */\n          console.debug(`Error while executing callback for ${nameSpace} for event ${event}`);\n          console.debug(e);\n          /* eslint-enable no-console */\n        }\n      });\n    }\n  }\n\n  sendLocalMessage({ event, data, nameSpace } = {}) {\n    const message = {\n      event,\n      data,\n      nameSpace,\n    };\n    this.local.postMessage(message, '*');\n  }\n\n  sendMessage({ event, data, nameSpace }) {\n    const message = {\n      event,\n      data,\n      nameSpace,\n    };\n    this.remote.postMessage(message, '*');\n  }\n\n  registerMessageHandler({ event, nameSpace, callback } = {}) {\n    if (\n      typeof callback !== 'function' ||\n      typeof event === 'undefined' ||\n      typeof nameSpace === 'undefined'\n    ) {\n      return;\n    }\n    if (!this.__messageHandlers[nameSpace]) {\n      this.__messageHandlers[nameSpace] = {};\n    }\n    if (!this.__messageHandlers[nameSpace][event]) {\n      this.__messageHandlers[nameSpace][event] = [];\n    }\n    this.__messageHandlers[nameSpace][event].push(callback);\n  }\n\n  removeMessageHandler({ event, nameSpace, callback } = {}) {\n    if (!this.__messageHandlers[nameSpace]) {\n      return;\n    }\n    if (!this.__messageHandlers[nameSpace][event]) {\n      return;\n    }\n    if (callback) {\n      const index = this.__messageHandlers[nameSpace][event].indexOf(callback);\n      if (index > -1) {\n        return this.__messageHandlers[nameSpace][event].splice(index, 1);\n      }\n    }\n    // no callback specified, remove all callbacks\n    this.__messageHandlers[nameSpace][event] = [];\n  }\n}\n\nexport default Mediator;\n","export const events = {\n  READYCHECK: 'readycheck',\n  READY: 'ready',\n  STATEUPDATE: 'stateupdate',\n  USERDATAUPDATE: 'userdataupdate',\n};\n\nexport const nameSpace = 'hashi';\n","import { events } from './hashiBase';\n\nexport default class BaseShim {\n  constructor(mediator) {\n    this.__mediator = mediator;\n    this.events = Object.assign({}, events);\n  }\n\n  setData(data) {\n    this.__setData(data);\n    this.stateUpdated();\n  }\n\n  setUserData(data) {\n    if (this.__setUserData) {\n      this.__setUserData(data);\n      this.userDataUpdated();\n    }\n  }\n\n  sendMessage(event, data) {\n    this.__mediator.sendMessage({ nameSpace: this.nameSpace, event, data });\n  }\n\n  on(event, callback) {\n    if (!Object.values(this.events).includes(event)) {\n      throw ReferenceError(`${event} is not a valid event name for ${this.nameSpace}`);\n    }\n    this.__mediator.registerMessageHandler({ nameSpace: this.nameSpace, event, callback });\n  }\n\n  off(event, callback) {\n    if (!Object.values(this.events).includes(event)) {\n      throw ReferenceError(`${event} is not a valid event name for ${this.nameSpace}`);\n    }\n    this.__mediator.removeMessageHandler({ nameSpace: this.nameSpace, event, callback });\n  }\n\n  stateUpdated() {\n    this.sendMessage(this.events.STATEUPDATE, this.data);\n  }\n\n  userDataUpdated() {\n    this.sendMessage(this.events.USERDATAUPDATE, this.userData);\n  }\n}\n","/**\n * This class offers an API-compatible replacement for localStorage and sessionStorage\n * to be used when apps are run in sandbox mode.\n *\n * For more information, see: https://developer.mozilla.org/en-US/docs/Web/API/Storage\n */\nimport BaseShim from './baseShim';\n\n// List out all the keys that exist on the shim itself to\n// prevent accidental overwriting.\n// We need to set data on the shim object to allow checks\n// of object membership with 'in'\nconst internalKeys = ['length', 'key', 'getItem', 'setItem', 'removeItem', 'clear'];\n\nexport default class BaseStorage extends BaseShim {\n  constructor(mediator) {\n    super(mediator);\n    this.data = {};\n  }\n\n  __setData(data = {}) {\n    this.data = data;\n    this.setDataToShim();\n  }\n\n  /*\n   * Method to check any changes\n   * in shim properties, due to direct property setting\n   * deletion, etc. that has not gone through setItem or removeItem\n   */\n  setDataFromShim() {\n    const updatedData = Object.assign({}, this.data);\n    let updated = false;\n    const shimKeys = Object.keys(this.shim);\n    // Won't include the object methods\n    shimKeys.forEach(key => {\n      // Ignore internal keys\n      if (!internalKeys.includes(key)) {\n        const value = String(this.shim[key]);\n        if (this.data[key] !== value) {\n          updatedData[key] = value;\n          updated = true;\n        }\n      }\n    });\n    Object.keys(this.data).forEach(key => {\n      if (!shimKeys.includes(key) && !internalKeys.includes(key)) {\n        delete updatedData[key];\n        updated = true;\n      }\n    });\n    if (updated) {\n      this.__setData(updatedData);\n      this.stateUpdated();\n    }\n  }\n\n  setDataToShim() {\n    if (this.shim) {\n      // Assign all data that is not keyed by\n      // one of our built in object keys\n      // onto our shim object.\n      Object.assign(\n        this.shim,\n        ...Object.entries(this.data)\n          .filter(entry => !internalKeys.includes(entry[0]))\n          .map(entry => ({ [entry[0]]: entry[1] }))\n      );\n      // Now remove any keys on the shim that shouldn't be there now.\n      const shimProps = Object.keys(this.shim);\n      shimProps.forEach(prop => {\n        if (!this.data[prop]) {\n          delete this.shim[prop];\n        }\n      });\n    }\n  }\n\n  iframeInitialize() {\n    this.__setShimInterface();\n    Object.defineProperty(window, this.nameSpace, {\n      value: this.shim,\n      configurable: true,\n    });\n  }\n\n  __setShimInterface() {\n    const self = this;\n\n    class Shim {\n      get length() {\n        self.setDataFromShim();\n        return Object.keys(self.data).length;\n      }\n\n      key(index) {\n        self.setDataFromShim();\n        // Return null if no key defined, as per storage spec.\n        return Object.keys(self.data)[index] || null;\n      }\n\n      getItem(keyName) {\n        self.setDataFromShim();\n        // Return null if no key defined, as per storage spec.\n        return self.data[keyName] || null;\n      }\n\n      setItem(keyName, value) {\n        // Can only store strings in localStorage\n        // by default everything is coerced to a string\n        // We follow the API to spec\n        value = String(value);\n        self.data[keyName] = value;\n        // Also store the value on the instance itself,\n        // unless it would overwrite a method.\n        if (!internalKeys.includes(keyName)) {\n          this[keyName] = value;\n        }\n        self.stateUpdated();\n      }\n\n      removeItem(keyName) {\n        delete self.data[keyName];\n        // Also delete the key on the instance itself,\n        // unless it would overwrite a method.\n        if (!internalKeys.includes(keyName)) {\n          delete this[keyName];\n        }\n        self.stateUpdated();\n      }\n\n      clear() {\n        self.data = {};\n        self.stateUpdated();\n      }\n    }\n    this.shim = new Shim();\n\n    this.setDataToShim();\n\n    return this.shim;\n  }\n}\n","/**\n * This class offers an API-compatible replacement for localStorage\n * to be used when apps are run in sandbox mode.\n *\n * localStorage is persisted outside the sandboxed iframe in case it is needed for future sessions\n *\n * For more information, see: https://developer.mozilla.org/en-US/docs/Web/API/Window/localStorage\n */\nimport BaseStorage from './baseStorage';\n\nexport default class LocalStorage extends BaseStorage {\n  constructor(mediator) {\n    super(mediator);\n    this.nameSpace = 'localStorage';\n    this.__setData = this.__setData.bind(this);\n    this.on(this.events.STATEUPDATE, this.__setData);\n  }\n}\n","/**\n * This class offers an API-compatible replacement document.cookie\n * to be used when apps are run in sandbox mode.\n *\n * For more information, see: https://developer.mozilla.org/en-US/docs/Web/API/document/cookie\n */\nimport BaseShim from './baseShim';\n\n// Value to set on expires that will prevent this data from being persisted\nconst sessionOnly = 'session';\n\nexport default class Cookie extends BaseShim {\n  constructor(mediator) {\n    super(mediator);\n    Object.assign(this.events, {\n      NOW: 'now',\n    });\n    this.nameSpace = 'cookie';\n    this.__clearData();\n    this.__nowDiff = 0;\n    this.__setData = this.__setData.bind(this);\n    this.__setNowDiff = this.__setNowDiff.bind(this);\n    this.__getCookies = this.__getCookies.bind(this);\n    this.__setItem = this.__setItem.bind(this);\n    this.on(this.events.STATEUPDATE, this.__setData);\n    this.on(this.events.NOW, this.__setNowDiff);\n  }\n\n  __clearData() {\n    const defaultData = {\n      rootCookies: {},\n      byPath: {},\n    };\n    this.__data = Object.assign({}, defaultData);\n  }\n\n  __removeExpiredCookies(data) {\n    const output = {\n      rootCookies: {},\n      byPath: {},\n    };\n\n    const filterCookies = sourceObj => {\n      const out = {};\n      Object.keys(sourceObj).forEach(key => {\n        if (new Date(sourceObj[key].expires) > this.__now()) {\n          out[key] = sourceObj[key];\n        }\n      });\n      return out;\n    };\n    output.rootCookies = filterCookies(data.rootCookies);\n    Object.keys(data.byPath).forEach(path => {\n      const filtered = filterCookies(data.byPath[path]);\n      if (Object.keys(filtered).length) {\n        // Only bother assigning if any cookies actually remain\n        output.byPath[path] = filtered;\n      }\n    });\n    return output;\n  }\n\n  __setData(data) {\n    if (data && data.rootCookies && data.byPath) {\n      this.__data = this.__removeExpiredCookies(data);\n    } else {\n      this.__clearData();\n    }\n  }\n\n  iframeInitialize() {\n    Object.defineProperty(document, this.nameSpace, {\n      get: this.__getCookies,\n      set: this.__setItem,\n      // By definition, the interfaces we are overwriting are configurable\n      // Because otherwise we couldn't configure them.\n      // Make sure ours is also in case someone else is monkey patching,\n      // to avoid causing errors for their code.\n      configurable: true,\n    });\n  }\n\n  get data() {\n    // Return data that should be persisted across sessions\n    const data = {\n      rootCookies: {},\n      byPath: {},\n    };\n\n    function filterCookies(sourceObj) {\n      const output = {};\n      Object.keys(sourceObj).forEach(key => {\n        if (sourceObj[key].expires !== sessionOnly) {\n          output[key] = sourceObj[key];\n        }\n      });\n      return output;\n    }\n    data.rootCookies = filterCookies(this.__data.rootCookies);\n    Object.keys(this.__data.byPath).forEach(path => {\n      const filtered = filterCookies(this.__data.byPath[path]);\n      if (Object.keys(filtered).length) {\n        data.byPath[path] = filtered;\n      }\n    });\n    return this.__removeExpiredCookies(data);\n  }\n\n  // Because we are persisting data across multiple client devices\n  // it can be helpful to have a single source of truth for timestamps\n  // that we persist. As such, we allow the setting of a time difference\n  // to allow our Hashi internal timestamps to be set relative to the\n  // current time on the Kolibri server.\n  // This may be no more accurate than the time on the client device,\n  // but at least it is consistent across client devices.\n  __now() {\n    return new Date(Date.now() + this.__nowDiff);\n  }\n\n  __setNowDiff(nowDiff) {\n    this.__nowDiff = nowDiff;\n  }\n\n  setNow(now) {\n    this.__setNowDiff(new Date(now).getTime() - Date.now());\n    this.sendMessage(this.events.NOW, this.__nowDiff);\n  }\n\n  __getCookies() {\n    const data = Object.assign({}, this.__data.rootCookies);\n    const pathname = window.location.pathname;\n    // Add additional cookies by specific path if defined.\n    // Overwrite root set cookies.\n    if (this.__data.byPath[pathname]) {\n      Object.assign(data, this.__data.byPath[pathname]);\n    }\n    return Object.keys(data)\n      .map(key => `${key}=${data[key].value}`)\n      .join('; ');\n  }\n\n  __setItem(valueString = '') {\n    const parts = valueString.split(';');\n    if (parts[0]) {\n      const [key, value] = parts[0].split('=');\n      const store = {\n        value,\n        expires: sessionOnly,\n      };\n      let path;\n      let deleteCookie = false;\n      const pathRegex = /path=(.+)/;\n      const maxAgeRegex = /max-age=(.+)/;\n      const expiresRegex = /expires=(.+)/;\n      parts.slice(1).forEach(part => {\n        try {\n          const pathResult = pathRegex.exec(part);\n          const maxAgeResult = maxAgeRegex.exec(part);\n          const expiresResult = expiresRegex.exec(part);\n          if (pathResult) {\n            path = pathResult[1];\n          } else if (maxAgeResult) {\n            // Let the function level catch handle any errors from parsing as a Number\n            const maxAge = Number(maxAgeResult[1]);\n            if (isNaN(maxAge)) {\n              // Not a number, so just ignore this flag.\n              return;\n            } else if (maxAge > 0) {\n              store.expires = new Date(this.__now().getTime() + maxAge);\n            } else {\n              // If the max age is 0 or less, then expire the cookie\n              deleteCookie = true;\n            }\n          } else if (expiresResult) {\n            const expirationDate = new Date(expiresResult[1]);\n            if (isNaN(expirationDate)) {\n              // Parsed date is invalid\n              return;\n            } else if (expirationDate <= Date.now()) {\n              // The cookie is set to expire in the past, so delete it\n              deleteCookie = true;\n            } else {\n              // Expiration is set for some time in the future, so normalize it to\n              // our corrected now.\n              // Don't worry about how far in the future, as, at a minimum, this\n              // cookie should persist across this session.\n              store.expires = new Date(\n                this.__now().getTime() + (expirationDate.getTime() - Date.now())\n              );\n            }\n          }\n        } catch (e) {\n          // document.cookie setting is very forgiving and doesn't seem to throw errors\n          // even when completely nonsense values are passed to its optional arguments,\n          // so catch any errors here.\n        }\n      });\n      if (deleteCookie) {\n        this.__removeItem(key, path);\n      } else {\n        if (path) {\n          if (!this.__data.byPath[path]) {\n            this.__data.byPath[path] = {};\n          }\n          this.__data.byPath[path][key] = store;\n        } else {\n          this.__data.rootCookies[key] = store;\n        }\n      }\n      this.stateUpdated();\n    }\n  }\n\n  __removeItem(key, path) {\n    if (path) {\n      if (this.__data.byPath[path]) {\n        delete this.__data.byPath[path][key];\n        if (!Object.keys(this.__data.byPath[path]).length) {\n          // If this is the last remaining entry, delete the parent object\n          // To keep everything shipshape, and Bristol fashion!\n          delete this.__data.byPath[path];\n        }\n      }\n    } else {\n      delete this.__data.rootCookies[key];\n    }\n    this.stateUpdated();\n  }\n}\n","/**\n * This class offers an API-compatible replacement window.API for SCORM modules\n * to be used when apps are run in sandbox mode.\n *\n * For more information, see:\n * https://scorm.com/scorm-explained/technical-scorm/run-time/run-time-reference/\n */\nimport BaseShim from './baseShim';\n\nconst logger = console; //eslint-disable-line no-console\n\nconst TRUE = 'true';\n\nconst FALSE = 'false';\n\nconst BLANK = '';\n\nconst ERRORS = {\n  NO_ERROR: 0,\n  GENERAL_EXCEPTION: 101,\n  INVALID_ARGUMENT_ERROR: 201,\n  ELEMENT_CANNOT_HAVE_CHILDREN: 202,\n  ELEMENT_NOT_AN_ARRAY: 203,\n  NOT_INITIALIZED: 301,\n  NOT_IMPLEMENTED_ERROR: 401,\n  ELEMENT_IS_KEYWORD: 402,\n  ELEMENT_IS_READ_ONLY: 403,\n  ELEMENT_IS_WRITE_ONLY: 404,\n  INCORRECT_DATA_TYPE: 405,\n};\n\nconst READ_WRITE = {\n  // For reverse lookup purposes, these constants must match\n  RO: 'RO',\n  RW: 'RW',\n  WO: 'WO',\n};\n\nconst CMIDecimal = {\n  validate(value) {\n    return !isNaN(value);\n  },\n};\n\n// Not clear whether the hours and minutes are optional, but setting them as so for safety.\n/* eslint-disable max-len */\nconst timeSpanRegex = /(?:([0-9]{4}|[0-9]{2}):)?(?:([0-5][0-9]):)?([0-5][0-9](?:\\.[0-9]{1,2})?)/;\n/* eslint-enable */\n\nconst CMITimeSpan = {\n  validate(value) {\n    return timeSpanRegex.test(value);\n  },\n  convertFromSeconds(seconds) {\n    const format = value => (value < 10 ? '0' + value : value);\n    // Round seconds to two decimal places\n    const s = Math.round((seconds % 60) * 100) / 100;\n    const m = Math.floor((seconds % 3600) / 60);\n    const h = Math.floor(seconds / 3600);\n    // CMITimeSpan has a limit of 4 digits for hours, so return ''\n    // here for safety if the number is too large\n    if (h >= 10000) {\n      return '';\n    }\n    return `${format(h)}:${format(m)}:${format(s)}`;\n  },\n};\n\n// This is a 24 hour clock time, so requires all digits.\n/* eslint-disable max-len */\nconst timeRegex = /((?:[0-1][0-9]|2[0-3])):([0-5][0-9]):([0-5][0-9](?:\\.[0-9]{1,2})?)/;\n/* eslint-enable */\n\nconst CMITime = {\n  validate(value) {\n    return timeRegex.test(value);\n  },\n};\n\nfunction isStringLike(value) {\n  // Note: explicitly using double equals here instead of triple equals\n  // to check that we have a coerceable type (so exclude undefined, null, and functions)\n  return String(value) == value;\n}\n\nconst CMIString255 = {\n  validate(value) {\n    return isStringLike(value) && String(value).length <= 255;\n  },\n};\n\nconst CMIString4096 = {\n  validate(value) {\n    return isStringLike(value) && String(value).length <= 4096;\n  },\n};\n\nconst CMIIdentifier = {\n  validate(value) {\n    // A 255 character string that does not contain any whitespace\n    // The spec says 'alphanumeric' but seems like this commonly means more\n    // than just [0-9a-zA-Z]:\n    // https://moodle.org/mod/forum/discuss.php?d=52947\n    return CMIString255.validate(value) && !/\\s/.test(value);\n  },\n};\n\nconst lowerCaseLetterNumber = /[0-9a-z]/;\n\nfunction singleLowerCaseLetterNumber(s) {\n  return s.length === 1 && lowerCaseLetterNumber.test(s);\n}\n\nconst trueFalse = /[01tf]/;\n\nconst CMIFeedback = {\n  validate(value, obj) {\n    if (value === BLANK) {\n      return true;\n    } else if (!isStringLike(value)) {\n      return false;\n    }\n    // Coerce the value to a string for validation\n    value = String(value);\n    if (obj.type === 'true-false') {\n      // Single character matching the valid true false characters\n      return trueFalse.test(value) && value.length === 1;\n    }\n    if (obj.type === 'choice') {\n      // Choice is comma separated list of 0-9 and a-z\n      // Can also be wrapped in curly braces\n      if (value[0] === '{') {\n        if (value[value.length - 1] === '}') {\n          value = value.substring(1, value.length - 1);\n        } else {\n          return false;\n        }\n      }\n      return value.split(',').every(singleLowerCaseLetterNumber);\n    }\n    if (obj.type === 'fill-in' || obj.type === 'performance') {\n      // Ensure it doesn't exceed the max length\n      if (value.length <= 255) {\n        return true;\n      }\n      return false;\n    }\n    if (obj.type === 'numeric') {\n      // Just validate that it's a number\n      return CMIDecimal.validate(value);\n    }\n    if (obj.type === 'likert') {\n      // A single lower case letter number character\n      return singleLowerCaseLetterNumber(value);\n    }\n    if (obj.type === 'matching') {\n      // Like the choice type, except that the comma separated\n      // values are pairs separted by '.'\n      // e.g. 'a.b,1.c'\n      if (value[0] === '{') {\n        if (value[value.length - 1] === '}') {\n          value = value.substring(1, value.length - 1);\n        } else {\n          return false;\n        }\n      }\n      return value.split(',').every(s => {\n        return s.length === 3 && s.split('.').every(singleLowerCaseLetterNumber);\n      });\n    }\n    if (obj.type === 'sequencing') {\n      // Comma separated list of single characters\n      return value.split(',').every(singleLowerCaseLetterNumber);\n    }\n    // No type, return true as we can't validate\n    return true;\n  },\n};\n\nconst SCORE_SCHEMA = {\n  hasChildren: true,\n  raw: {\n    type: CMIDecimal,\n    readWrite: READ_WRITE.RW,\n  },\n  min: {\n    type: CMIDecimal,\n    readWrite: READ_WRITE.RW,\n  },\n  max: {\n    type: CMIDecimal,\n    readWrite: READ_WRITE.RW,\n  },\n};\n\nconst STATUS_SCHEMA = {\n  readWrite: READ_WRITE.RW,\n  values: {\n    passed: 'passed',\n    completed: 'completed',\n    failed: 'failed',\n    incomplete: 'incomplete',\n    browsed: 'browsed',\n    'not attempted': 'not attempted',\n    '': '',\n  },\n};\n\nconst SCHEMA = {\n  cmi: {\n    hasChildren: true,\n    core: {\n      hasChildren: true,\n      student_id: {\n        type: CMIIdentifier,\n        fromUserData(userData) {\n          return userData.userId || '';\n        },\n        readWrite: READ_WRITE.RO,\n      },\n      student_name: {\n        type: CMIString255,\n        fromUserData(userData) {\n          return userData.userFullName || '';\n        },\n        readWrite: READ_WRITE.RO,\n      },\n      lesson_location: {\n        type: CMIString255,\n        readWrite: READ_WRITE.RW,\n      },\n      credit: {\n        fromUserData(userData) {\n          return userData.userId ? 'credit' : 'no-credit';\n        },\n        readWrite: READ_WRITE.RO,\n      },\n      lesson_status: STATUS_SCHEMA,\n      entry: {\n        fromUserData(userData) {\n          if (userData.progress) {\n            return userData.progress < 1 ? 'resume' : '';\n          }\n          return 'ab-initio';\n        },\n        readWrite: READ_WRITE.RO,\n      },\n      score: SCORE_SCHEMA,\n      total_time: {\n        type: CMITimeSpan,\n        fromUserData(userData) {\n          return CMITimeSpan.convertFromSeconds(userData.timeSpent ? userData.timeSpent : 0);\n        },\n        readWrite: READ_WRITE.RO,\n      },\n      lesson_mode: {\n        fromUserData(userData) {\n          if (userData.userId) {\n            return userData.complete ? 'review' : 'normal';\n          }\n          return 'browse';\n        },\n        readWrite: READ_WRITE.RO,\n      },\n      exit: {\n        readWrite: READ_WRITE.WO,\n        values: {\n          'time-out': 'time-out',\n          suspend: 'suspend',\n          logout: 'logout',\n          '': '',\n        },\n      },\n      session_time: {\n        type: CMITimeSpan,\n        readWrite: READ_WRITE.WO,\n      },\n    },\n    launch_data: {\n      type: CMIString4096,\n      readWrite: READ_WRITE.RO,\n    },\n    comments: {\n      type: CMIString4096,\n      readWrite: READ_WRITE.RW,\n    },\n    comments_from_lms: {\n      type: CMIString4096,\n      readWrite: READ_WRITE.RO,\n    },\n    objectives: {\n      hasChildren: true,\n      arraySchema: {\n        id: {\n          type: CMIIdentifier,\n          readWrite: READ_WRITE.RW,\n        },\n        score: SCORE_SCHEMA,\n        status: STATUS_SCHEMA,\n      },\n    },\n    // We don't currently support any of the student_data subkeys\n    student_data: {\n      hasChildren: true,\n      mastery_score: {\n        notImplemented: true,\n        readWrite: READ_WRITE.RO,\n      },\n      max_time_allowed: {\n        notImplemented: true,\n        readWrite: READ_WRITE.RO,\n      },\n      time_limit_action: {\n        notImplemented: true,\n        readWrite: READ_WRITE.RO,\n      },\n    },\n    student_preference: {\n      hasChildren: true,\n      language: {\n        type: CMIString255,\n        fromUserData(userData) {\n          return userData.language ? userData.language : '';\n        },\n        readWrite: READ_WRITE.RW,\n      },\n      audio: {\n        notImplemented: true,\n        readWrite: READ_WRITE.RW,\n      },\n      speed: {\n        notImplemented: true,\n        readWrite: READ_WRITE.RW,\n      },\n      text: {\n        notImplemented: true,\n        readWrite: READ_WRITE.RW,\n      },\n    },\n    interactions: {\n      hasChildren: true,\n      arraySchema: {\n        id: {\n          type: CMIIdentifier,\n          readWrite: READ_WRITE.RW,\n        },\n        objectives: {\n          arraySchema: {\n            id: {\n              type: CMIIdentifier,\n              readWrite: READ_WRITE.WO,\n            },\n          },\n        },\n        time: {\n          type: CMITime,\n          readWrite: READ_WRITE.WO,\n        },\n        type: {\n          readWrite: READ_WRITE.WO,\n          values: {\n            'true-false': 'true-false',\n            choice: 'choice',\n            'fill-in': 'fill-in',\n            matching: 'matching',\n            performance: 'performance',\n            sequencing: 'sequencing',\n            likert: 'likert',\n            numeric: 'numeric',\n            '': '',\n          },\n        },\n        correct_responses: {\n          arraySchema: {\n            pattern: {\n              readWrite: READ_WRITE.WO,\n            },\n          },\n        },\n        weighting: {\n          type: CMIDecimal,\n          readWrite: READ_WRITE.WO,\n        },\n        student_response: {\n          type: CMIFeedback,\n          readWrite: READ_WRITE.WO,\n        },\n        result: {\n          readWrite: READ_WRITE.WO,\n          validate(value) {\n            const values = {\n              correct: 'correct',\n              wrong: 'wrong',\n              unanticipated: 'unanticipated',\n              neutral: 'neutral',\n              '': '',\n            };\n            return CMIDecimal.validate(value) || values[value];\n          },\n        },\n        latency: {\n          readWrite: READ_WRITE.WO,\n          type: CMITimeSpan,\n        },\n      },\n    },\n    suspend_data: {\n      type: CMIString4096,\n      readWrite: READ_WRITE.RW,\n    },\n  },\n};\n\nconst SCORM_ERROR_NAME = 'SCORMError';\n\nfunction throwError(errorCode) {\n  const error = TypeError(errorCode);\n  error.name = SCORM_ERROR_NAME;\n  throw error;\n}\n\n// Vendored and modified from\n// https://github.com/dfahlander/Dexie.js/blob/2337c0fcb093219c07723f81363b806d203f5c8b/src/functions/utils.ts#L118\n\nexport function getByKeyPath(obj, keyPath, localSchema, userData) {\n  // If a keyPath is empty, if no schema exists for it, or if it is not a string\n  // throw an invalid argument error.\n  if (!keyPath || !localSchema || typeof keyPath !== 'string') {\n    throwError(ERRORS.INVALID_ARGUMENT_ERROR);\n  }\n  // If we are trying to read from a write only property, throw an error\n  if (localSchema[keyPath] && localSchema[keyPath].readWrite === READ_WRITE.WO) {\n    throwError(ERRORS.ELEMENT_IS_WRITE_ONLY);\n  }\n  // If we have defined how this is derived from user data that is fed in from\n  // Kolibri, then return this value instead of looking for it in our data object.\n  if (localSchema[keyPath] && localSchema[keyPath].fromUserData) {\n    return localSchema[keyPath].fromUserData(userData);\n  }\n  // http://www.w3.org/TR/IndexedDB/#steps-for-extracting-a-key-from-a-value-using-a-key-path\n  // This works for getting values from Objects by key and from Arrays by index\n  if (obj && Object.prototype.hasOwnProperty.call(obj, keyPath)) {\n    return obj[keyPath];\n  }\n  const period = keyPath.indexOf('.');\n  // If there is a separator still in the keyPath\n  if (period !== -1) {\n    const leadingKeyPath = keyPath.substr(0, period);\n    const innerObj = obj ? obj[leadingKeyPath] : obj;\n    const innerKeyPath = keyPath.substr(period + 1);\n    let innerSchema = localSchema[leadingKeyPath];\n    if (innerSchema && innerSchema.arraySchema) {\n      // If the inner schema is for an array, pass\n      // the arraySchema instead\n      innerSchema = innerSchema.arraySchema;\n    } else if (!isNaN(leadingKeyPath)) {\n      // If the path is indexing into an array,\n      // we keep the array schema from the parent\n      innerSchema = localSchema;\n    }\n    if (innerKeyPath === '_count') {\n      // If the inner key is requesting a count, we check that we have a valid schema\n      // for the keyPath up until this point, and check that this is for an array in the schema\n      if (localSchema[leadingKeyPath] && localSchema[leadingKeyPath].arraySchema) {\n        // It is, so first we check if the data object has an array\n        if (Array.isArray(innerObj)) {\n          // If so, return this array's length\n          return innerObj.length;\n        } else {\n          // If not, it is effectively a zero length array\n          return 0;\n        }\n      } else {\n        // Otherwise, they tried to get the length of an element that is not an array in the\n        // schema - throw the appropriate error.\n        throwError(ERRORS.ELEMENT_NOT_AN_ARRAY);\n      }\n    }\n    if (innerKeyPath === '_children') {\n      // If the inner key is requesting the children, check to see that we have a valid schema\n      // for the keyPath up until this point, and check that this has children\n      if (localSchema[leadingKeyPath] && localSchema[leadingKeyPath].hasChildren) {\n        // If so, return the child keys of the appropriate inner schema (by using innerSchema\n        // we can expose the children of array properties as well).\n        return (\n          Object.keys(innerSchema)\n            // Filter out the `hasChildren` key which is our own special marker.\n            // Also filter out keys that we have not implemented yet.\n            .filter(key => key !== 'hasChildren' && !innerSchema[key].notImplemented)\n            .join(',')\n        );\n      } else {\n        // Otherwise, they tried to get the children of a property that does not allow it\n        // throw the appropriate error.\n        throwError(ERRORS.ELEMENT_CANNOT_HAVE_CHILDREN);\n      }\n    }\n    // Recurse further to get the data we are after.\n    return getByKeyPath(innerObj, innerKeyPath, innerSchema, userData);\n  }\n  // If we have got to this point, we do not a representation of the relevant\n  // keyPath in the object, and we have finished recursing through the keyPath\n  // Check if the remaining keyPath is in the schema at all and if we support it\n  if (localSchema[keyPath] && !localSchema[keyPath].notImplemented) {\n    // If so, just return a blank response, which is always valid.\n    return BLANK;\n  } else if (localSchema[keyPath] && localSchema[keyPath].notImplemented) {\n    // If it is in the schema but not implemented, return the appropriate error\n    throwError(ERRORS.NOT_IMPLEMENTED_ERROR);\n  }\n  // Otherwise, this is not a valid argument, so throw here.\n  throwError(ERRORS.INVALID_ARGUMENT_ERROR);\n}\n\nexport function setByKeyPath(obj, keyPath, value, localSchema) {\n  // Can't set blank keyPaths on non-existent schemas that are not strings!\n  if (!keyPath || !localSchema || typeof keyPath !== 'string') {\n    throwError(ERRORS.INVALID_ARGUMENT_ERROR);\n  }\n  // Check to see if we still need to recurse the keyPath\n  const period = keyPath.indexOf('.');\n  if (period !== -1) {\n    // If so, get the first part of the keyPath before the first separator\n    const leadingKeyPath = keyPath.substr(0, period);\n    // Get the remainder of the keyPath after the first separator\n    const innerKeyPath = keyPath.substr(period + 1);\n    // Try getting the relevant subsection of the schema for this subsection\n    // of the keyPath\n    let innerSchema = localSchema[leadingKeyPath];\n    if (innerSchema && innerSchema.arraySchema) {\n      // If the inner schema is for an array, pass\n      // the arraySchema instead\n      innerSchema = innerSchema.arraySchema;\n      // Set the inner object to an Array here, to prevent it\n      // being set to an object later:\n      obj[leadingKeyPath] = obj[leadingKeyPath] || [];\n    } else if (!isNaN(leadingKeyPath)) {\n      // If the path is indexing into an array,\n      // we keep the array schema from the parent\n      innerSchema = localSchema;\n    }\n    // If the remaining key path we are after is either for a count or children\n    // we can raise an error here, as we are not allowed to set these.\n    if (innerKeyPath === '_count' || innerKeyPath === '_children') {\n      throwError(ERRORS.ELEMENT_IS_KEYWORD);\n    }\n    // In case we have not set any data in this part of the object before,\n    // initialize the key to a blank object if not already initialized.\n    obj[leadingKeyPath] = obj[leadingKeyPath] || {};\n    // Recurse the key path setting!\n    setByKeyPath(obj[leadingKeyPath], innerKeyPath, value, innerSchema);\n  } else {\n    const innerSchema = localSchema[keyPath];\n    // If we are trying to write to a read only property, throw an error\n    if (innerSchema && innerSchema.readWrite === READ_WRITE.RO) {\n      throwError(ERRORS.ELEMENT_IS_READ_ONLY);\n    }\n    // If we are trying to write to a property we have not implemented, throw an error\n    if (innerSchema && innerSchema.notImplemented) {\n      throwError(ERRORS.NOT_IMPLEMENTED_ERROR);\n    }\n    // If we are trying to write to a property that does not exist on the schema, throw an error\n    if (!innerSchema) {\n      throwError(ERRORS.INVALID_ARGUMENT_ERROR);\n    }\n    // Conduct validation based on the schema we have inferred.\n    if (\n      // First check if we have a defined type and run validation against it\n      (innerSchema.type && !innerSchema.type.validate(value, obj)) ||\n      // If there is a directly defined validation function on the schema,\n      // check that\n      (innerSchema.validate && !innerSchema.validate(value, obj)) ||\n      // If the schema defines a set of allowed values, check that it is\n      // included.\n      (innerSchema.values && !innerSchema.values[value]) ||\n      // Otherwise, if there is no defined type and nothing else is set for\n      // validation, just check that the value is valid as a string.\n      (!innerSchema.type && !isStringLike(value))\n    ) {\n      throwError(ERRORS.INCORRECT_DATA_TYPE);\n    }\n    // If we've got this far, we can set the value!\n    obj[keyPath] = value;\n  }\n}\n\nconst statusProgressMap = {\n  passed: 1,\n  failed: 0.5,\n  browsed: 0.5,\n  'not attempted': 0,\n  incomplete: 0.5,\n};\n\nexport default class SCORM extends BaseShim {\n  constructor(mediator) {\n    super(mediator);\n    this.data = {};\n    this.userData = {};\n    this.nameSpace = 'SCORM';\n    this.__setData = this.__setData.bind(this);\n    this.__setUserData = this.__setUserData.bind(this);\n    this.on(this.events.STATEUPDATE, this.__setData);\n    this.on(this.events.USERDATAUPDATE, this.__setUserData);\n  }\n\n  __setData(data = {}) {\n    this.data = data;\n  }\n\n  __setUserData(userData = {}) {\n    this.userData = userData;\n  }\n\n  __calculateProgress() {\n    const score = getByKeyPath(this.data, 'cmi.core.score', SCHEMA, self.userData);\n    if (score) {\n      // If min and max are not set, raw will be a value in the range 0-100. Source:\n      // https://support.scorm.com/hc/en-us/articles/206166466-cmi-score-raw-whole-numbers-\n      const min = Number(isNaN(score.min) ? 0 : score.min);\n      const max = Number(isNaN(score.max) ? 100 : score.max);\n      const raw = Number(isNaN(score.raw) ? min : score.raw);\n      return Math.max(Math.min((raw - min) / (max - min), 1), 0);\n    }\n    const lessonStatus = getByKeyPath(this.data, 'cmi.core.lesson_status', SCHEMA, self.userData);\n    if (Object.prototype.hasOwnProperty.call(statusProgressMap, lessonStatus)) {\n      return statusProgressMap[lessonStatus];\n    }\n    // Return null if we have no progress information to report.\n    return null;\n  }\n\n  iframeInitialize() {\n    this.__setShimInterface();\n    try {\n      window.parent.API = this.shim;\n    } catch (e) {\n      if (e instanceof DOMException) {\n        // If this is a result of trying to touch a secure property\n        // this will be a DOMException error. Catch and just return nothing.\n        logger.warn(\n          'Tried to setup the SCORM API in a sandboxed environment, it will not be enabled'\n        );\n        return;\n      }\n      throw e;\n    }\n  }\n\n  __setShimInterface() {\n    const self = this;\n\n    let error = ERRORS.NO_ERROR;\n\n    class Shim {\n      LMSInitialize() {\n        logger.debug('LMS Initialize called');\n        self.stateUpdated();\n        return TRUE;\n      }\n\n      LMSFinish() {\n        logger.debug('LMS Finish called');\n        return TRUE;\n      }\n      LMSSetValue(CMIElement, value) {\n        error = ERRORS.NO_ERROR;\n        logger.debug(`LMSSetValue called with path: ${CMIElement} and value ${value}`);\n        try {\n          setByKeyPath(self.data, CMIElement, value, SCHEMA);\n        } catch (e) {\n          if (e instanceof TypeError && e.name === SCORM_ERROR_NAME) {\n            error = e.message;\n            return FALSE;\n          }\n          throw e;\n        }\n        self.stateUpdated();\n        return TRUE;\n      }\n\n      LMSGetValue(CMIElement) {\n        error = ERRORS.NO_ERROR;\n        logger.debug(`LMSGetValue called with path: ${CMIElement}`);\n        try {\n          return getByKeyPath(self.data, CMIElement, SCHEMA, self.userData);\n        } catch (e) {\n          if (e instanceof TypeError && e.name === SCORM_ERROR_NAME) {\n            error = e.message;\n            return BLANK;\n          }\n          throw e;\n        }\n      }\n\n      LMSCommit() {\n        error = ERRORS.NO_ERROR;\n        logger.debug('LMS Commit called');\n        return TRUE;\n      }\n\n      LMSGetLastError() {\n        return error;\n      }\n\n      LMSGetErrorString(errorCode) {\n        logger.debug(`LMS Get Error String called with code ${errorCode}`);\n        return BLANK;\n      }\n\n      LMSGetDiagnostic(errorCode) {\n        logger.debug(`LMS Get Diagnostic called with code ${errorCode}`);\n        return BLANK;\n      }\n    }\n    this.shim = new Shim();\n\n    return this.shim;\n  }\n}\n","import Mediator from './mediator';\nimport LocalStorage from './localStorage';\nimport Cookie from './cookie';\nimport SCORM from './SCORM';\nimport { events, nameSpace } from './hashiBase';\n\n/*\n * This is the main entry point for interacting with the Hashi library.\n * Import this client in order to wrap an iframe that has an instance of\n * the 'SandboxEnvironment' class (found inside iframeClient.js) inside of it.\n * When an iframe has been wrapped, then this class can be initialized to set initial\n * data, and allow the iframe to setup its own environment and start running\n * a contained HTML5 app.\n */\nexport default class MainClient {\n  constructor({ iframe, now } = {}) {\n    this.events = events;\n    this.iframe = iframe;\n    if (this.iframe.name !== nameSpace) {\n      throw ReferenceError(\n        `Iframe passed to Hashi must have been initialized with name attribute ${nameSpace}`\n      );\n    }\n    this.mediator = new Mediator(this.iframe.contentWindow);\n    this.storage = {\n      localStorage: new LocalStorage(this.mediator),\n      cookie: new Cookie(this.mediator),\n      SCORM: new SCORM(this.mediator),\n    };\n    this.now = now;\n    this.__setData = this.__setData.bind(this);\n  }\n  initialize(contentState, userData) {\n    /*\n     * userData should be an object with the following keys, all optional:\n     * userId: <user ID>,\n     * userFullName: <user's full name>,\n     * progress: <current progress between 0 and 1>,\n     * complete: <boolean of whether complete or not>,\n     * timeSpent: <time spent in seconds>,\n     * language: <language code>,\n     */\n    this.__setData(contentState, userData);\n    this.__setListeners();\n    // Set this here so that any time the inner frame declares it is ready\n    // it can reinitialize its SandboxEnvironment.\n    this.on(this.events.READY, () => {\n      this.__setData(this.data, this.userData);\n      this.mediator.sendMessage({ nameSpace, event: events.READY, data: true });\n    });\n    this.mediator.sendMessage({ nameSpace, event: events.READYCHECK, data: true });\n  }\n\n  updateData({ contentState, userData }) {\n    // Make a quick copy of the contentState and userData that is passed in.\n    // Can do this as all contentState that is coming in should be JSON\n    // compatible in the first place, if not, we have other problems.\n    if (userData) {\n      userData = JSON.parse(JSON.stringify(userData));\n      this.userData = userData;\n    }\n    if (contentState) {\n      contentState = JSON.parse(JSON.stringify(contentState));\n    }\n    Object.keys(this.storage).forEach(key => {\n      const storage = this.storage[key];\n      if (contentState && contentState[storage.nameSpace]) {\n        storage.setData(contentState[storage.nameSpace]);\n      }\n      if (userData) {\n        storage.setUserData(userData);\n      }\n    });\n  }\n\n  getProgress() {\n    // Return any calculated progress from the storage APIs\n    // So far, only the SCORM shim supports this\n    // If no progress has been reported, this will be null.\n    return this.storage.SCORM.__calculateProgress();\n  }\n\n  __setData(contentState, userData) {\n    this.updateData({ contentState, userData });\n    if (this.now) {\n      this.storage.cookie.setNow(this.now());\n    }\n  }\n  __setListeners() {\n    Object.keys(this.storage).forEach(key => {\n      const storage = this.storage[key];\n      storage.on(events.STATEUPDATE, () => {\n        this.mediator.sendLocalMessage({ nameSpace, event: events.STATEUPDATE, data: this.data });\n      });\n    });\n  }\n  get data() {\n    const data = {};\n    Object.keys(this.storage).forEach(key => {\n      const storage = this.storage[key];\n      // Make a quick copy of the data that is being exposed\n      // to prevent direct access to the stored data.\n      data[storage.nameSpace] = JSON.parse(JSON.stringify(storage.data));\n    });\n    return data;\n  }\n  on(event, callback) {\n    if (!Object.values(events).includes(event)) {\n      throw ReferenceError(`${event} is not a valid event name for ${nameSpace}`);\n    }\n    this.mediator.registerMessageHandler({ nameSpace, event, callback });\n  }\n\n  onStateUpdate(callback) {\n    this.on(events.STATEUPDATE, callback);\n  }\n\n  onProgressUpdate(callback) {\n    this.on(events.PROGRESSUPDATE, callback);\n  }\n}\n","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\nimport { now } from 'kolibri.utils.serverClock';\nimport CoreFullscreen from 'kolibri.coreVue.components.CoreFullscreen';\nimport Hashi from 'hashi';\nimport { nameSpace } from 'hashi/src/hashiBase';\nimport plugin_data from 'plugin_data';\n\n// Regex vendored from https://github.com/faisalman/ua-parser-js/blob/master/src/ua-parser.js\nconst iOSTest = /ip[honead]{2,4}(?:.*os\\s([\\w]+)\\slike\\smac|;\\sopera)/i;\nconst IE11Test = /(trident).+rv[:\\s]([\\w.]+).+like\\sgecko/i;\n\nconst defaultContentHeight = '500px';\nconst frameTopbarHeight = '37px';\nconst pxStringAdd = (x, y) => parseInt(x, 10) + parseInt(y, 10) + 'px';\n\nexport default {\n  name: 'Html5AppRendererIndex',\n  components: {\n    CoreFullscreen,\n  },\n  data() {\n    return {\n      isInFullscreen: false,\n    };\n  },\n  computed: {\n    name() {\n      return nameSpace;\n    },\n    rooturl() {\n      const iOS = iOSTest.test(navigator.userAgent);\n      const iOSorIE11 = iOS || IE11Test.test(navigator.userAgent);\n      // Skip hashi on requests for these browsers\n      return this.defaultFile.storage_url + (iOSorIE11 ? '?SKIP_HASHI=true' : '');\n    },\n    iframeHeight() {\n      return (this.options && this.options.height) || defaultContentHeight;\n    },\n    iframeWidth() {\n      return (this.options && this.options.width) || 'auto';\n    },\n    contentRendererHeight() {\n      return pxStringAdd(this.iframeHeight, frameTopbarHeight);\n    },\n    sandbox() {\n      return plugin_data.html5_sandbox_tokens;\n    },\n    fullscreenText() {\n      return this.isInFullscreen ? this.$tr('exitFullscreen') : this.$tr('enterFullscreen');\n    },\n    userData() {\n      return {\n        userId: this.userId,\n        userFullName: this.userFullName,\n        progress: this.progress,\n        complete: this.progress >= 1,\n        language: this.lang.id,\n        timeSpent: this.timeSpent,\n      };\n    },\n    containerStyle() {\n      if (this.isInFullscreen) {\n        return {\n          position: 'absolute',\n          top: frameTopbarHeight,\n          bottom: 0,\n        };\n      }\n      return { height: this.iframeHeight };\n    },\n  },\n  watch: {\n    userData(newValue) {\n      if (newValue && this.hashi) {\n        this.hashi.updateData({ userData: newValue });\n      }\n    },\n  },\n  mounted() {\n    this.hashi = new Hashi({ iframe: this.$refs.iframe, now });\n    this.hashi.onStateUpdate(data => {\n      this.$emit('updateContentState', data);\n    });\n    this.hashi.initialize(\n      (this.extraFields && this.extraFields.contentState) || {},\n      this.userData\n    );\n    this.$emit('startTracking');\n    this.startTime = now();\n    this.pollProgress();\n  },\n  beforeDestroy() {\n    if (this.timeout) {\n      clearTimeout(this.timeout);\n    }\n    this.$emit('stopTracking');\n  },\n  methods: {\n    recordProgress() {\n      const totalTime = now() - this.startTime;\n      const hashiProgress = this.hashi ? this.hashi.getProgress() : null;\n      this.$emit(\n        'updateProgress',\n        hashiProgress === null ? Math.max(0, totalTime / 300000) : hashiProgress\n      );\n      this.pollProgress();\n    },\n    pollProgress() {\n      this.timeout = setTimeout(() => {\n        this.recordProgress();\n      }, 15000);\n    },\n  },\n  $trs: {\n    exitFullscreen: 'Exit Fullscreen',\n    enterFullscreen: 'View Fullscreen',\n  },\n};\n\n","import mod from \"-!../../../../../../node_modules/buble-loader/index.js??ref--2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/svg-icon-inline-loader/index.js!./Html5AppRendererIndex.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../node_modules/buble-loader/index.js??ref--2!../../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../node_modules/svg-icon-inline-loader/index.js!./Html5AppRendererIndex.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Html5AppRendererIndex.vue?vue&type=template&id=3448014e&scoped=true&\"\nimport script from \"./Html5AppRendererIndex.vue?vue&type=script&lang=js&\"\nexport * from \"./Html5AppRendererIndex.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Html5AppRendererIndex.vue?vue&type=style&index=0&id=3448014e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3448014e\",\n  null\n  \n)\n\nexport default component.exports","export default function setWebpackPublicPath(urls) {\n  if (process.env.NODE_ENV === 'production') {\n    /* eslint-disable no-undef */\n    __webpack_public_path__ = urls.static(`${__kolibriModuleName}/`);\n    /* eslint-enable */\n  }\n}\n","/* globals __VUE_SSR_CONTEXT__ */\n\n// IMPORTANT: Do NOT use ES2015 features in this file (except for modules).\n// This module is a runtime utility for cleaner component module output and will\n// be included in the final webpack user bundle.\n\nexport default function normalizeComponent (\n  scriptExports,\n  render,\n  staticRenderFns,\n  functionalTemplate,\n  injectStyles,\n  scopeId,\n  moduleIdentifier, /* server only */\n  shadowMode /* vue-cli only */\n) {\n  // Vue.extend constructor export interop\n  var options = typeof scriptExports === 'function'\n    ? scriptExports.options\n    : scriptExports\n\n  // render functions\n  if (render) {\n    options.render = render\n    options.staticRenderFns = staticRenderFns\n    options._compiled = true\n  }\n\n  // functional template\n  if (functionalTemplate) {\n    options.functional = true\n  }\n\n  // scopedId\n  if (scopeId) {\n    options._scopeId = 'data-v-' + scopeId\n  }\n\n  var hook\n  if (moduleIdentifier) { // server build\n    hook = function (context) {\n      // 2.3 injection\n      context =\n        context || // cached call\n        (this.$vnode && this.$vnode.ssrContext) || // stateful\n        (this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext) // functional\n      // 2.2 with runInNewContext: true\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__\n      }\n      // inject component styles\n      if (injectStyles) {\n        injectStyles.call(this, context)\n      }\n      // register component module identifier for async chunk inferrence\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier)\n      }\n    }\n    // used by ssr in case component is cached and beforeCreate\n    // never gets called\n    options._ssrRegister = hook\n  } else if (injectStyles) {\n    hook = shadowMode\n      ? function () {\n        injectStyles.call(\n          this,\n          (options.functional ? this.parent : this).$root.$options.shadowRoot\n        )\n      }\n      : injectStyles\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // for template-only hot-reload because in that case the render fn doesn't\n      // go through the normalizer\n      options._injectStyles = hook\n      // register for functional component in vue file\n      var originalRender = options.render\n      options.render = function renderWithStyleInjection (h, context) {\n        hook.call(context)\n        return originalRender(h, context)\n      }\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate\n      options.beforeCreate = existing\n        ? [].concat(existing, hook)\n        : [hook]\n    }\n  }\n\n  return {\n    exports: scriptExports,\n    options: options\n  }\n}\n","/**\n * KolibriModule module.\n * Provides the base class for Kolibri Modules - all Kolibri Modules must extend this Base class.\n * @module kolibriModule\n */\n\nimport coreApp from 'kolibri';\nimport urls from 'kolibri.urls';\nimport setWebpackPublicPath from './utils/setWebpackPublicPath';\n\n// Do this to set a public path for this module\nsetWebpackPublicPath(urls);\n\nexport default class KolibriModule {\n  /**\n   * An array of options to select from the options object passed into the constructor.\n   * @type {string[]}\n   */\n  get kolibriModuleOptions() {\n    return [];\n  }\n  /**\n   * The constructor function for the base KolibriModule object.\n   * @param {object} options - an options hash to set properties of the object.\n   * @param {Array} args - any additional arguments that will be passed to initialize.\n   * @constructor\n   */\n  constructor(options, ...args) {\n    /* eslint-disable no-undef */\n    // __kolibriModuleName is replaced during webpack compilation with the name derived from\n    // the unique_slug that is defined on the class that defines the frontend kolibriModule.\n    this.name = __kolibriModuleName;\n    /* eslint-enable no-undef */\n    const safeOptions = {};\n    this.kolibriModuleOptions.forEach(option => {\n      if (options[option]) {\n        safeOptions[option] = options[option];\n      }\n    });\n    Object.assign(this, safeOptions);\n    // Pass all arguments to the constructor directly to initialize for easy access.\n    this.initialize(options, ...args);\n    // Register the kolibriModule with the Kolibri core app.\n    this._registerKolibriModule();\n  }\n\n  /**\n   * Method to automatically register the kolibriModule with the Kolibri core app once it has\n   * initialized.\n   * @private\n   */\n  _registerKolibriModule() {\n    coreApp.registerKolibriModuleSync(this);\n  }\n\n  /**\n   * A dummy initialization function - this function will be passed anything passed to the\n   * constructor.\n   * Useful for setting up the kolibriModule before it is registered against the Kolibri core app.\n   */\n  initialize() {}\n\n  /**\n   * A dummy ready function\n   * Useful for initiating behaviour of the kolibriModule after it is registered against the\n   * Kolibri core app.\n   */\n  ready() {}\n\n  /**\n   * Convenience method to unregister the kolibriModule from listening to certain events.\n   * @param {string} event - the event name\n   * @param {string} method - the name of the method to unbind\n   */\n  stopListening(event, method) {\n    coreApp.stopListening(event, this, method);\n  }\n\n  /**\n   * Convenience method to fire an event on the global Mediator and pass in a data payload.\n   * @param {string} event - the event name\n   * @param {Array} args - additional arguments to the event handler.\n   */\n  emit(...args) {\n    coreApp.emit(...args);\n  }\n  get Kolibri() {\n    return coreApp;\n  }\n}\n","import HTML5AppComponent from './views/Html5AppRendererIndex';\nimport ContentRendererModule from 'content_renderer_module';\n\nclass HTML5AppModule extends ContentRendererModule {\n  get rendererComponent() {\n    return HTML5AppComponent;\n  }\n}\n\nconst hTML5AppModule = new HTML5AppModule();\n\nexport { hTML5AppModule as default };\n","import KolibriModule from 'kolibri_module';\n\nexport default class ContentRenderer extends KolibriModule {\n  get rendererComponent() {\n    return null;\n  }\n  loadDirectionalCSS(direction) {\n    return this.Kolibri.loadDirectionalCSS(this, direction);\n  }\n}\n"],"sourceRoot":""}